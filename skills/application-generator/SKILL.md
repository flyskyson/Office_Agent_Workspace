# ç”³è¯·ä¹¦ç”ŸæˆæŠ€èƒ½ (Application Generator)

**æè¿°**: å¸‚åœºç›‘ç®¡ç”³è¯·ä¹¦è‡ªåŠ¨ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒè¥ä¸šæ‰§ç…§OCRè¯†åˆ«ã€Wordæ¨¡æ¿å¡«å……ã€æ ¼å¼éªŒè¯ã€‚å½“ç”¨æˆ·éœ€è¦"ç”Ÿæˆç”³è¯·ä¹¦"ã€"å¡«å†™ç”³è¯·è¡¨"ã€"åˆ›å»ºç”³è¯·æ–‡æ¡£"ã€"ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç™»è®°"ã€"åŠæ‰§ç…§"ã€"å¼€åº—ç”³è¯·"æ—¶è§¦å‘æ­¤æŠ€èƒ½ã€‚é€‚ç”¨äºå¸‚åœºç›‘ç®¡ã€è¯ç…§åŠç†ã€ä¼ä¸šç™»è®°ç­‰åœºæ™¯ã€‚ä¸æ”¯æŒæ³•å¾‹å’¨è¯¢æˆ–æ”¿ç­–è§£è¯»ã€‚

**ğŸ”¥ çƒ­é‡è½½æµ‹è¯•**: ä¿®æ”¹äº 2026-01-14ï¼Œæ·»åŠ äº†"åŠæ‰§ç…§"ã€"å¼€åº—ç”³è¯·"è§¦å‘è¯ï¼Œç«‹å³ç”Ÿæ•ˆï¼

---

## æ¦‚è¿°

æœ¬æŠ€èƒ½è‡ªåŠ¨åŒ–ç”Ÿæˆ**ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç™»è®°ç”³è¯·ä¹¦**ï¼Œæ ¸å¿ƒæµç¨‹ï¼š
1. ä»è¥ä¸šæ‰§ç…§å›¾ç‰‡æå–ä¿¡æ¯ï¼ˆOCRï¼‰
2. éªŒè¯å¹¶è¡¥å……æ•°æ®åº“ä¿¡æ¯
3. ä½¿ç”¨ Jinja2 å¡«å…… Word æ¨¡æ¿
4. ç”Ÿæˆæ ¼å¼åŒ–çš„ç”³è¯·æ–‡æ¡£

**å…³é”®ä¼˜åŠ¿**ï¼š
- è‡ªåŠ¨åŒ– OCR è¯†åˆ«ï¼Œå‡å°‘æ‰‹åŠ¨è¾“å…¥
- æ¨¡æ¿åŒ–ç”Ÿæˆï¼Œç¡®ä¿æ ¼å¼ç»Ÿä¸€
- æ•°æ®åº“éªŒè¯ï¼Œé¿å…ä¿¡æ¯é”™è¯¯
- ä¸€é”®è¾“å‡ºï¼Œé«˜æ•ˆä¾¿æ·

---

## å‰ç½®æ¡ä»¶

### å¿…éœ€æ–‡ä»¶
```
01_Active_Projects/market_supervision_agent/
â”œâ”€â”€ jinja2_filler.py              # æ ¸å¿ƒç”Ÿæˆå™¨
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ database_schema.yaml      # æ•°æ®åº“å­—æ®µå®šä¹‰
â”‚   â””â”€â”€ ocr_config.yaml           # OCRé…ç½®
â””â”€â”€ templates/
    â””â”€â”€ ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦ï¼ˆæœ€ç»ˆç‰ˆï¼‰.docx  # Wordæ¨¡æ¿
```

### ç¯å¢ƒä¾èµ–
```bash
pip install python-docx jinja2 pillow paddleocr
```

### è¾“å…¥æ•°æ®
- è¥ä¸šæ‰§ç…§å›¾ç‰‡ï¼ˆæ”¯æŒ JPG/PNGï¼‰
- æˆ–å·²å½•å…¥çš„æ•°æ®åº“è®°å½•

---

## æ‰§è¡Œæ­¥éª¤

### æ­¥éª¤ 1: ç¡®å®šç”Ÿæˆæ–¹å¼

**è¯¢é—®ç”¨æˆ·**ï¼š
```
æ‚¨æƒ³é€šè¿‡å“ªç§æ–¹å¼ç”Ÿæˆç”³è¯·ä¹¦ï¼Ÿ
A. ä¸Šä¼ è¥ä¸šæ‰§ç…§å›¾ç‰‡ï¼ˆOCRè¯†åˆ«ï¼‰
B. ä½¿ç”¨æ•°æ®åº“å·²æœ‰è®°å½•
C. æ‰‹åŠ¨è¾“å…¥ä¿¡æ¯
```

---

### æ­¥éª¤ 2A: OCR è¯†åˆ«ï¼ˆé€‰æ‹©Aæ—¶ï¼‰

**æ‰§è¡Œå‘½ä»¤**ï¼š
```bash
cd 01_Active_Projects/market_supervision_agent
python jinja2_filler.py --ocr <è¥ä¸šæ‰§ç…§å›¾ç‰‡è·¯å¾„>
```

**OCR å¼•æ“é€‰æ‹©**ï¼š
- ä¼˜å…ˆä½¿ç”¨ï¼šç™¾åº¦ OCRï¼ˆéœ€é…ç½® API Keyï¼‰
- å¤‡ç”¨ï¼šPaddleOCRï¼ˆæœ¬åœ°å…è´¹ï¼‰

**æå–å­—æ®µ**ï¼š
- ç»è¥è€…å§“å
- ç»è¥åœºæ‰€åœ°å€
- ç»è¥èŒƒå›´
- ç»„æˆå½¢å¼
- æ³¨å†Œæ—¥æœŸ

---

### æ­¥éª¤ 2B: æ•°æ®åº“æŸ¥è¯¢ï¼ˆé€‰æ‹©Bæ—¶ï¼‰

**è®¿é—® Web ç•Œé¢**ï¼š
```bash
cd 01_Active_Projects/market_supervision_agent
python ui/flask_app.py
# è®¿é—® http://127.0.0.1:5000
```

**æŸ¥è¯¢è®°å½•**ï¼š
- ä½¿ç”¨æ•°æ®åº“ç®¡ç†ç•Œé¢æµè§ˆå·²æœ‰è®°å½•
- é€‰æ‹©éœ€è¦ç”Ÿæˆç”³è¯·ä¹¦çš„è®°å½•

---

### æ­¥éª¤ 2C: æ‰‹åŠ¨è¾“å…¥ï¼ˆé€‰æ‹©Cæ—¶ï¼‰

**å¯åŠ¨è¡¨å•ç•Œé¢**ï¼š
```bash
cd 01_Active_Projects/market_supervision_agent
python jinja2_filler.py --interactive
```

**å¿…å¡«å­—æ®µ**ï¼š
```
ç»è¥è€…å§“å: ___________
ç»è¥åœºæ‰€: ___________
ç»è¥èŒƒå›´: ___________
ç»„æˆå½¢å¼: ___________
è”ç³»ç”µè¯: ___________
```

---

### æ­¥éª¤ 3: æ¨¡æ¿å¡«å……

**æ ¸å¿ƒä»£ç **ï¼š
```python
from jinja2_filler import ApplicationFiller

filler = ApplicationFiller(
    template_path="templates/ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦ï¼ˆæœ€ç»ˆç‰ˆï¼‰.docx",
    config_path="config/database_schema.yaml"
)

# å¡«å……æ•°æ®
data = {
    "operator_name": "å¼ ä¸‰",
    "business_address": "XXå¸‚XXåŒºXXè¡—é“XXå·",
    "business_scope": "é¤é¥®æœåŠ¡",
    "composition_form": "ä¸ªäººç»è¥",
    # ... æ›´å¤šå­—æ®µ
}

output_path = filler.fill_template(data)
print(f"ç”³è¯·ä¹¦å·²ç”Ÿæˆ: {output_path}")
```

**Jinja2 æ¨¡æ¿è¯­æ³•**ï¼š
```
ç»è¥è€…å§“åï¼š{{ operator_name }}
ç»è¥åœºæ‰€ï¼š{{ business_address }}
ç»è¥èŒƒå›´ï¼š{{ business_scope }}
```

---

### æ­¥éª¤ 4: æ ¼å¼éªŒè¯

**éªŒè¯é¡¹ç›®**ï¼š
- âœ… æ‰€æœ‰å¿…å¡«å­—æ®µå·²å¡«å……
- âœ… åœ°å€æ ¼å¼æ­£ç¡®ï¼ˆçœå¸‚åŒºè¡—é“é—¨ç‰Œå·ï¼‰
- âœ… è”ç³»ç”µè¯æ ¼å¼ï¼ˆ11ä½æ‰‹æœºå·æˆ–åº§æœºï¼‰
- âœ… ç»è¥èŒƒå›´ç¬¦åˆè§„èŒƒç”¨è¯­
- âœ… Word æ–‡æ¡£å¯æ­£å¸¸æ‰“å¼€

**éªŒè¯å¤±è´¥å¤„ç†**ï¼š
```
[è­¦å‘Š] ä»¥ä¸‹å­—æ®µç¼ºå¤±æˆ–æ ¼å¼é”™è¯¯ï¼š
- è”ç³»ç”µè¯: æ ¼å¼ä¸æ­£ç¡®
- ç»è¥èŒƒå›´: åŒ…å«ç¦æ­¢ç”¨è¯­

è¯·ä¿®æ­£åé‡æ–°ç”Ÿæˆã€‚
```

---

### æ­¥éª¤ 5: è¾“å‡ºæ–‡æ¡£

**è¾“å‡ºä½ç½®**ï¼š
```
01_Active_Projects/market_supervision_agent/generated_applications/
â””â”€â”€ ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦_å¼ ä¸‰_20260113.docx
```

**æ–‡ä»¶å‘½åè§„åˆ™**ï¼š
```
{ç”³è¯·ç±»å‹}_{ç»è¥è€…å§“å}_{æ—¥æœŸ}.{ext}
```

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: å¿«é€Ÿç”Ÿæˆï¼ˆOCRï¼‰

```
ä½ : å¸®æˆ‘ç”Ÿæˆä¸ªä½“å·¥å•†æˆ·ç”³è¯·ä¹¦ï¼Œè¿™æ˜¯è¥ä¸šæ‰§ç…§

[ä¸Šä¼  license.jpg]

æˆ‘: æ£€æµ‹åˆ°è¥ä¸šæ‰§ç…§å›¾ç‰‡ï¼Œæ­£åœ¨ä½¿ç”¨ OCR è¯†åˆ«...
    âœ… è¯†åˆ«æˆåŠŸï¼š
       ç»è¥è€…ï¼šæå››
       åœ°å€ï¼šå—å®å¸‚é’ç§€åŒº...
       èŒƒå›´ï¼šé£Ÿå“é”€å”®

    æ­£åœ¨ç”Ÿæˆç”³è¯·ä¹¦...
    âœ… ç”Ÿæˆå®Œæˆï¼šgenerated_applications/ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦_æå››_20260113.docx

    è¦é¢„è§ˆæˆ–ä¸‹è½½å—ï¼Ÿ
```

---

### ç¤ºä¾‹ 2: æ‰¹é‡ç”Ÿæˆ

```
ä½ : ä»æ•°æ®åº“ç”Ÿæˆ10ä»½ç”³è¯·ä¹¦

æˆ‘: å¥½çš„ï¼Œä»æ•°æ®åº“è¯»å–è®°å½•...

    æ­£åœ¨æ‰¹é‡å¤„ç†ï¼š
    [==========] 100% 10/10

    âœ… å·²ç”Ÿæˆ10ä»½ç”³è¯·ä¹¦ï¼š
       1. ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦_å¼ ä¸‰_20260113.docx
       2. ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦_æå››_20260113.docx
       ...

    è¦æ‰“åŒ…ä¸‹è½½å—ï¼Ÿ
```

---

### ç¤ºä¾‹ 3: æ›´æ–°å·²æœ‰ç”³è¯·ä¹¦

```
ä½ : æ›´æ–°æå››çš„ç”³è¯·ä¹¦ï¼Œä¿®æ”¹è”ç³»ç”µè¯

æˆ‘: å¥½çš„ï¼Œæ‰¾åˆ°æå››çš„ç”³è¯·ä¹¦è®°å½•

    åŸç”µè¯ï¼š138XXXX1234
    æ–°ç”µè¯ï¼š139XXXX5678

    æ­£åœ¨é‡æ–°ç”Ÿæˆ...
    âœ… æ›´æ–°å®Œæˆï¼šgenerated_applications/ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç”³è¯·ä¹¦_æå››_20260113_v2.docx
```

---

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|---------|
| `TemplateNotFound` | æ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨ | æ£€æŸ¥ [templates/](01_Active_Projects/market_supervision_agent/templates/) ç›®å½• |
| `OCRFailedError` | OCRè¯†åˆ«å¤±è´¥ | æ£€æŸ¥å›¾ç‰‡æ¸…æ™°åº¦ï¼Œå°è¯•å¤‡ç”¨OCRå¼•æ“ |
| `MissingFieldError` | å¿…å¡«å­—æ®µç¼ºå¤± | è¡¥å……å®Œæ•´ä¿¡æ¯åé‡æ–°ç”Ÿæˆ |
| `WordFormatError` | Wordæ–‡æ¡£æŸå | ä½¿ç”¨å¤‡ç”¨æ¨¡æ¿ |

### è°ƒè¯•æ¨¡å¼

```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
python jinja2_filler.py --debug --ocr license.jpg
```

---

## é…ç½®è¯´æ˜

### OCR é…ç½®

ç¼–è¾‘ [config/ocr_config.yaml](01_Active_Projects/market_supervision_agent/config/ocr_config.yaml)ï¼š

```yaml
ocr_engine:
  primary: "baidu"  # ä¸»è¦å¼•æ“
  fallback: "paddleocr"  # å¤‡ç”¨å¼•æ“

baidu_ocr:
  api_key: "your-api-key"
  secret_key: "your-secret-key"

paddleocr:
  use_gpu: false
  lang: "ch"
```

### å­—æ®µæ˜ å°„

ç¼–è¾‘ [config/database_schema.yaml](01_Active_Projects/market_supervision_agent/config/database_schema.yaml)ï¼š

```yaml
fields:
  operator_name:
    required: true
    label: "ç»è¥è€…å§“å"
    type: "string"
  business_address:
    required: true
    label: "ç»è¥åœºæ‰€"
    type: "string"
```

---

## å±€é™è¯´æ˜

**æœ¬æŠ€èƒ½æ— æ³•å¤„ç†**ï¼š
- âŒ æ³•å¾‹å’¨è¯¢æˆ–æ”¿ç­–è§£è¯»
- âŒ è¶…å‡ºæ¨¡æ¿æ ¼å¼çš„ç‰¹æ®Šéœ€æ±‚
- âŒ éä¸ªä½“å·¥å•†æˆ·ç±»å‹çš„ç”³è¯·ï¼ˆå¦‚ä¼ä¸šæ³•äººï¼‰
- âŒ è¥ä¸šæ‰§ç…§ä»¥å¤–çš„è¯ä»¶è¯†åˆ«

**éœ€è¦äººå·¥å®¡æ ¸**ï¼š
- âš ï¸ ç»è¥èŒƒå›´æ˜¯å¦ç¬¦åˆæ³•è§„
- âšº ç»è¥åœºæ‰€æ˜¯å¦çœŸå®å­˜åœ¨
- âšº ç‰¹æ®Šè¡Œä¸šæ˜¯å¦éœ€è¦è®¸å¯è¯

---

## æ‰©å±•åŠŸèƒ½

### æ·»åŠ æ–°æ¨¡æ¿

1. å°†æ–°æ¨¡æ¿æ”¾å…¥ [templates/](01_Active_Projects/market_supervision_agent/templates/) ç›®å½•
2. åœ¨ [config/database_schema.yaml](01_Active_Projects/market_supervision_agent/config/database_schema.yaml) æ·»åŠ å­—æ®µæ˜ å°„
3. æ›´æ–°æœ¬æŠ€èƒ½æ–‡æ¡£

### è‡ªå®šä¹‰å­—æ®µ

```python
# åœ¨ jinja2_filler.py ä¸­æ·»åŠ 
custom_fields = {
    "æ³¨å†Œæ—¥æœŸ": datetime.now().strftime("%Yå¹´%mæœˆ%dæ—¥"),
    "ç”³è¯·æ—¥æœŸ": datetime.now().strftime("%Yå¹´%mæœˆ%dæ—¥"),
}
```

---

## ç›¸å…³æ–‡ä»¶

- **æ ¸å¿ƒä»£ç **: [01_Active_Projects/market_supervision_agent/jinja2_filler.py](../../01_Active_Projects/market_supervision_agent/jinja2_filler.py)
- **Webç•Œé¢**: [01_Active_Projects/market_supervision_agent/ui/flask_app.py](../../01_Active_Projects/market_supervision_agent/ui/flask_app.py)
- **é…ç½®æ–‡ä»¶**: [01_Active_Projects/market_supervision_agent/config/](../../01_Active_Projects/market_supervision_agent/config/)
- **æ¨¡æ¿ç›®å½•**: [01_Active_Projects/market_supervision_agent/templates/](../../01_Active_Projects/market_supervision_agent/templates/)
- **è¾“å‡ºç›®å½•**: [01_Active_Projects/market_supervision_agent/generated_applications/](../../01_Active_Projects/market_supervision_agent/generated_applications/)

---

## ç‰ˆæœ¬å†å²

- **v1.0** (2026-01-13): åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒOCRè¯†åˆ«å’Œæ¨¡æ¿å¡«å……

---

**æŠ€èƒ½è§¦å‘å…³é”®è¯**: `ç”Ÿæˆç”³è¯·ä¹¦`ã€`å¡«å†™ç”³è¯·è¡¨`ã€`åˆ›å»ºç”³è¯·æ–‡æ¡£`ã€`ä¸ªä½“å·¥å•†æˆ·å¼€ä¸š`ã€`è¥ä¸šæ‰§ç…§ç”³è¯·`
