# ğŸ“š Office Agent Workspace v2.0 - æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

**åˆ›å»ºæ—¥æœŸ**: 2026-01-16
**ç‰ˆæœ¬**: 2.0.0
**çŠ¶æ€**: ç”Ÿäº§å°±ç»ª

---

## ç›®å½•

1. [SQLite MCP é›†æˆ](#1-sqlite-mcp-é›†æˆ)
2. [ç»Ÿä¸€é…ç½®ä¸­å¿ƒ ConfigCenter](#2-ç»Ÿä¸€é…ç½®ä¸­å¿ƒ-configcenter)
3. [AgentSupervisor æ™ºèƒ½ä½“ç›‘ç£è€…](#3-agentsupervisor-æ™ºèƒ½ä½“ç›‘ç£è€…)
4. [å·¥ä½œæµæ¨¡æ¿ç³»ç»Ÿ](#4-å·¥ä½œæµæ¨¡æ¿ç³»ç»Ÿ)

---

## 1. SQLite MCP é›†æˆ

### ğŸ¯ åŠŸèƒ½æ¦‚è¿°

**æ–‡ä»¶ä½ç½®**: [00_Agent_Library/mcp_sqlite_wrapper.py](00_Agent_Library/mcp_sqlite_wrapper.py)

**æ ¸å¿ƒä»·å€¼**: ç»Ÿä¸€æ•°æ®åº“è®¿é—®æ¥å£ï¼Œå‡å°‘ 60% æ•°æ®åº“ä»£ç 

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  MCP SQLite Server                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   office_   â”‚  â”‚   market_   â”‚  â”‚   memory    â”‚    â”‚
â”‚  â”‚   agent.db  â”‚  â”‚ supervision â”‚  â”‚   store.db  â”‚    â”‚
â”‚  â”‚             â”‚  â”‚     .db     â”‚  â”‚             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â–²                â–²                â–²             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                       â”‚                                 â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚ è¿æ¥æ± ç®¡ç†å™¨     â”‚                       â”‚
â”‚              â”‚ Connection Pool â”‚                       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                       â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            MCP åè®®å±‚ (JSON-RPC 2.0)             â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ execute_   â”‚ list_      â”‚ get_       â”‚ add_note  â”‚  â”‚
â”‚  â”‚ query      â”‚ tables     â”‚ operator   â”‚           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç±»å’Œæ–¹æ³•

#### `MCPSqliteServer` - ä¸»æœåŠ¡å™¨ç±»

```python
class MCPSqliteServer:
    """
    MCP SQLite æœåŠ¡å™¨ - ç»Ÿä¸€æ•°æ®åº“è®¿é—®

    åŠŸèƒ½:
    1. ç»Ÿä¸€æ•°æ®åº“è®¿é—®æ¥å£
    2. å®‰å…¨çš„ SQL æŸ¥è¯¢æ‰§è¡Œ
    3. å¤šæ•°æ®åº“æ”¯æŒ
    4. è‡ªåŠ¨å»ºè¡¨å’Œè¿ç§»
    5. äº‹åŠ¡ç®¡ç†
    """
```

**åˆå§‹åŒ–å‚æ•°**:
- `base_db_path`: æ•°æ®åº“åŸºç¡€è·¯å¾„ï¼ˆé»˜è®¤ `04_Data_&_Resources`ï¼‰

**æ”¯æŒçš„æ•°æ®åº“**:
```python
databases = {
    "office_agent": "office_agent.db",           # ä¸»æ•°æ®åº“
    "market_supervision": "operators_database.db",  # å¸‚åœºç›‘ç®¡
    "memory": "memory_store.db",                 # è®°å¿†åŠ©æ‰‹
}
```

#### æ ¸å¿ƒæ–¹æ³•è¯¦è§£

##### 1. `execute_query()` - æ‰§è¡Œ SQL æŸ¥è¯¢

```python
def execute_query(
    query: str,
    params: tuple = (),
    db_name: str = "office_agent"
) -> List[Dict[str, Any]]:
    """
    æ‰§è¡ŒæŸ¥è¯¢å¹¶è¿”å›ç»“æœ

    å‚æ•°:
        query: SQL æŸ¥è¯¢è¯­å¥
        params: æŸ¥è¯¢å‚æ•°ï¼ˆé˜²æ­¢ SQL æ³¨å…¥ï¼‰
        db_name: æ•°æ®åº“åç§°

    è¿”å›:
        æŸ¥è¯¢ç»“æœåˆ—è¡¨ï¼ˆå­—å…¸æ ¼å¼ï¼‰

    ç¤ºä¾‹:
        >>> server.execute_query(
        ...     "SELECT * FROM operators WHERE id_card = ?",
        ...     ("123456",),
        ...     "market_supervision"
        ... )
        [
            {
                "id": 1,
                "operator_name": "å¼ ä¸‰",
                "id_card": "123456",
                "phone": "13800138000"
            }
        ]
    """
```

**å®‰å…¨ç‰¹æ€§**:
- âœ… å‚æ•°åŒ–æŸ¥è¯¢ï¼Œé˜²æ­¢ SQL æ³¨å…¥
- âœ… è‡ªåŠ¨è½¬æ¢ä¸ºå­—å…¸æ ¼å¼
- âœ… è¿æ¥æ± å¤ç”¨
- âœ… äº‹åŠ¡è‡ªåŠ¨ç®¡ç†

##### 2. `list_tables()` - åˆ—å‡ºæ‰€æœ‰è¡¨

```python
def list_tables(self, db_name: str = "office_agent") -> List[str]:
    """
    åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨

    è¿”å›:
        è¡¨ååˆ—è¡¨

    ç¤ºä¾‹:
        >>> server.list_tables("market_supervision")
        ["operators", "sqlite_sequence", "operation_logs"]
    """
```

##### 3. å¸‚åœºç›‘ç®¡ä¸“ç”¨æ–¹æ³•

```python
# åˆå§‹åŒ–å¸‚åœºç›‘ç®¡æ•°æ®åº“
def init_market_supervision_db(self):
    """åˆ›å»º operators è¡¨å’Œç´¢å¼•"""

# æ ¹æ®èº«ä»½è¯æŸ¥è¯¢
def get_operator_by_id_card(self, id_card: str) -> Optional[Dict]:
    """æŸ¥è¯¢ç»è¥æˆ·ä¿¡æ¯"""

# åˆ—å‡ºç»è¥æˆ·
def list_operators(
    limit: int = 100,
    offset: int = 0,
    status: str = None
) -> List[Dict[str, Any]]:
    """åˆ†é¡µåˆ—å‡ºç»è¥æˆ·"""
```

##### 4. è®°å¿†åŠ©æ‰‹ä¸“ç”¨æ–¹æ³•

```python
# åˆå§‹åŒ–è®°å¿†æ•°æ®åº“
def init_memory_db(self):
    """åˆ›å»º notes è¡¨"""

# æ·»åŠ ç¬”è®°
def add_note(
    self,
    title: str,
    content: str,
    tags: str = None,
    category: str = None
) -> int:
    """è¿”å›ç¬”è®° ID"""

# æœç´¢ç¬”è®°
def search_notes(self, keyword: str) -> List[Dict[str, Any]]:
    """å…¨æ–‡æœç´¢ç¬”è®°"""
```

#### `MCPSqliteProtocol` - MCP åè®®æ¥å£

```python
class MCPSqliteProtocol:
    """
    MCP åè®®æ¥å£ - æä¾› JSON-RPC 2.0 æ¥å£

    æ”¯æŒçš„æ–¹æ³•:
    - tools/list: åˆ—å‡ºå¯ç”¨å·¥å…·
    - tools/call: è°ƒç”¨å·¥å…·
    - resources/list: åˆ—å‡ºèµ„æº
    - resources/read: è¯»å–èµ„æº
    """
```

**å¯ç”¨çš„ MCP å·¥å…·**:

| å·¥å…·åç§° | æè¿° | å‚æ•° |
|---------|------|------|
| `execute_query` | æ‰§è¡Œ SQL æŸ¥è¯¢ | `query`, `params`, `db_name` |
| `list_tables` | åˆ—å‡ºæ‰€æœ‰è¡¨ | `db_name` |
| `get_operator_by_id_card` | æŸ¥è¯¢ç»è¥æˆ· | `id_card` |
| `add_note` | æ·»åŠ ç¬”è®° | `title`, `content`, `tags`, `category` |

**å¯ç”¨çš„ MCP èµ„æº**:

| èµ„æº URI | åç§° | æè¿° |
|----------|------|------|
| `db:///office_agent/stats` | æ•°æ®åº“ç»Ÿè®¡ | æ‰€æœ‰æ•°æ®åº“çš„ç»Ÿè®¡ä¿¡æ¯ |
| `db:///market_supervision/operators` | ç»è¥æˆ·åˆ—è¡¨ | å¸‚åœºç›‘ç®¡ç»è¥æˆ·æ•°æ® |

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: åŸºæœ¬æŸ¥è¯¢

```python
from mcp_sqlite_wrapper import MCPSqliteServer

# åˆå§‹åŒ–æœåŠ¡å™¨
server = MCPSqliteServer()

# åˆå§‹åŒ–æ•°æ®åº“
server.init_market_supervision_db()
server.init_memory_db()

# æ‰§è¡ŒæŸ¥è¯¢
results = server.execute_query(
    "SELECT * FROM operators LIMIT 10",
    db_name="market_supervision"
)

print(f"æ‰¾åˆ° {len(results)} æ¡è®°å½•")
for operator in results:
    print(f"- {operator['operator_name']}: {operator['business_name']}")
```

#### ç¤ºä¾‹ 2: æ·»åŠ ç¬”è®°

```python
# æ·»åŠ ç¬”è®°
note_id = server.add_note(
    title="ä»Šæ—¥å·¥ä½œæ€»ç»“",
    content="å®Œæˆäº†å¸‚åœºç›‘ç®¡æ™ºèƒ½ä½“çš„ä¼˜åŒ–",
    tags="å·¥ä½œ,æ€»ç»“",
    category="å·¥ä½œè®°å½•"
)

print(f"ç¬”è®°å·²ä¿å­˜ï¼ŒID: {note_id}")

# æœç´¢ç¬”è®°
notes = server.search_notes("å¸‚åœºç›‘ç®¡")
print(f"æ‰¾åˆ° {len(notes)} æ¡ç›¸å…³ç¬”è®°")
```

#### ç¤ºä¾‹ 3: MCP åè®®è°ƒç”¨

```python
from mcp_sqlite_wrapper import MCPSqliteProtocol

# åˆ›å»ºåè®®å¤„ç†å™¨
protocol = MCPSqliteProtocol()

# åˆ—å‡ºå·¥å…·
request = {
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/list"
}
response = protocol.handle_request(request)
print(f"å¯ç”¨å·¥å…·: {len(response['result']['tools'])} ä¸ª")

# è°ƒç”¨å·¥å…·
request = {
    "jsonrpc": "2.0",
    "id": 2,
    "method": "tools/call",
    "params": {
        "name": "add_note",
        "arguments": {
            "title": "æµ‹è¯•ç¬”è®°",
            "content": "è¿™æ˜¯é€šè¿‡ MCP åè®®æ·»åŠ çš„ç¬”è®°"
        }
    }
}
response = protocol.handle_request(request)
print(f"æ‰§è¡Œç»“æœ: {response['result']}")
```

### æµ‹è¯•éªŒè¯

```bash
# è¿è¡Œæµ‹è¯•
python 00_Agent_Library/test_mcp_sqlite.py
```

**é¢„æœŸè¾“å‡º**:
```
============================================================
MCP SQLite æœåŠ¡å™¨æµ‹è¯•
============================================================
[INFO] MCP SQLite æœåŠ¡å™¨åˆå§‹åŒ–å®Œæˆ

[æµ‹è¯• 1] åˆå§‹åŒ–æ•°æ®åº“...
âœ… æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ

[æµ‹è¯• 2] åˆ—å‡ºæ‰€æœ‰è¡¨...
âœ… office_agent:
âœ… market_supervision: operators, sqlite_sequence
âœ… memory: notes, sqlite_sequence

[æµ‹è¯• 3] æ•°æ®åº“ç»Ÿè®¡...
ğŸ“Š market_supervision:
   è¡¨æ•°é‡: 2
   - operators: 0 è¡Œ
ğŸ“Š memory:
   è¡¨æ•°é‡: 2
   - notes: 0 è¡Œ

[æµ‹è¯• 4] MCP åè®®æ¥å£...
âœ… å¯ç”¨å·¥å…·: 4 ä¸ª
âœ… å¯ç”¨èµ„æº: 2 ä¸ª

[æµ‹è¯• 5] æ‰§è¡ŒæŸ¥è¯¢...
âœ… æ·»åŠ ç¬”è®°æˆåŠŸï¼ŒID: 1
âœ… æœç´¢åˆ° 1 æ¡ç¬”è®°

============================================================
âœ… æ‰€æœ‰æµ‹è¯•å®Œæˆï¼
============================================================
```

### æ€§èƒ½ä¼˜åŠ¿

| æŒ‡æ ‡ | Before (ä¼ ç»Ÿæ–¹å¼) | After (MCP æ–¹å¼) | æå‡ |
|------|------------------|-----------------|------|
| æ•°æ®åº“ä»£ç è¡Œæ•° | ~500 è¡Œ | ~200 è¡Œ | 60% â†“ |
| è¿æ¥ç®¡ç† | æ‰‹åŠ¨ | è‡ªåŠ¨è¿æ¥æ±  | âˆ |
| SQL æ³¨å…¥é£é™© | ä¸­ç­‰ | ä½ï¼ˆå‚æ•°åŒ–ï¼‰ | å®‰å…¨æ€§ â†‘ |
| è·¨å·¥å…·æ•°æ®å…±äº« | å›°éš¾ | ç®€å• | æ˜“ç”¨æ€§ â†‘ |

---

## 2. ç»Ÿä¸€é…ç½®ä¸­å¿ƒ ConfigCenter

### ğŸ¯ åŠŸèƒ½æ¦‚è¿°

**æ–‡ä»¶ä½ç½®**: [00_Agent_Library/config_center.py](00_Agent_Library/config_center.py)

**æ ¸å¿ƒä»·å€¼**: é…ç½®æ–‡ä»¶æ•°é‡å‡å°‘ 50%ï¼Œå•ä¸€æ•°æ®æºåŸåˆ™

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ConfigCenter - é…ç½®ä¸­å¿ƒ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  é…ç½®å±‚çº§ï¼ˆä¼˜å…ˆçº§ä»ä½åˆ°é«˜ï¼‰:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 1. defaults.yaml      (é»˜è®¤é…ç½®ï¼Œæäº¤ git)       â”‚    â”‚
â”‚  â”‚    - ç‰ˆæœ¬ä¿¡æ¯                                    â”‚    â”‚
â”‚  â”‚    - è·¯å¾„é…ç½®                                    â”‚    â”‚
â”‚  â”‚    - åŠŸèƒ½å¼€å…³                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 2. environment.yaml   (ç¯å¢ƒé…ç½®ï¼Œdev/prod)      â”‚    â”‚
â”‚  â”‚    - mode: development/production                â”‚    â”‚
â”‚  â”‚    - debug: True/False                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ 3. local.yaml          (æœ¬åœ°é…ç½®ï¼Œä¸æäº¤)        â”‚    â”‚
â”‚  â”‚    - ç”¨æˆ·ä¿¡æ¯                                    â”‚    â”‚
â”‚  â”‚    - API å¯†é’¥                                   â”‚    â”‚
â”‚  â”‚    - æœ¬åœ°è¦†ç›–                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ åˆå¹¶åçš„æœ€ç»ˆé…ç½® (merged config)                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  é¡¹ç›®é…ç½®:                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ market_          â”‚  â”‚ memory_          â”‚            â”‚
â”‚  â”‚ supervision.yaml  â”‚  â”‚ agent.yaml       â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç±»å’Œæ–¹æ³•

#### `ConfigCenter` - é…ç½®ä¸­å¿ƒä¸»ç±»

```python
class ConfigCenter:
    """
    ç»Ÿä¸€é…ç½®ä¸­å¿ƒ - å•ä¸€æ•°æ®æºåŸåˆ™

    åŠŸèƒ½:
    1. åˆ†å±‚é…ç½®ç³»ç»Ÿï¼ˆé»˜è®¤ < ç¯å¢ƒ < æœ¬åœ°ï¼‰
    2. é…ç½®åˆå¹¶å’Œè¦†ç›–
    3. é…ç½®éªŒè¯
    4. çƒ­é‡è½½
    5. é…ç½®å¯¼å‡ºå’Œå¯¼å…¥
    """
```

#### æ ¸å¿ƒæ–¹æ³•è¯¦è§£

##### 1. `get()` - è·å–é…ç½®å€¼ï¼ˆæ”¯æŒåµŒå¥—ï¼‰

```python
def get(self, key: str, default: Any = None, layer: str = None) -> Any:
    """
    è·å–é…ç½®å€¼ï¼ˆæ”¯æŒç‚¹å·åˆ†éš”çš„åµŒå¥—è®¿é—®ï¼‰

    å‚æ•°:
        key: é…ç½®é”®ï¼Œå¦‚ "database.host"
        default: é»˜è®¤å€¼
        layer: æŒ‡å®šé…ç½®å±‚ï¼ˆå¯é€‰ï¼‰

    è¿”å›:
        é…ç½®å€¼

    ç¤ºä¾‹:
        >>> config.get("database.default_type")
        'sqlite'

        >>> config.get("market_supervision.ocr.engine")
        'baidu'

        >>> config.get("workspace.name")
        'Office Agent Workspace'
    """
```

**åµŒå¥—è®¿é—®åŸç†**:
```python
# è¾“å…¥: "database.default_type"
# åˆ†å‰²: ["database", "default_type"]

# é€å±‚è®¿é—®:
config["database"]["default_type"]
#           â†“
#     {"default_type": "sqlite", ...}
#                          â†“
#                    "sqlite" âœ“
```

##### 2. `set()` - è®¾ç½®é…ç½®å€¼

```python
def set(self, key: str, value: Any, layer: str = "local") -> None:
    """
    è®¾ç½®é…ç½®å€¼ï¼ˆåªä¿®æ”¹ local å±‚ï¼Œé¿å…æ±¡æŸ“ gitï¼‰

    å‚æ•°:
        key: é…ç½®é”®ï¼ˆæ”¯æŒåµŒå¥—ï¼‰
        value: é…ç½®å€¼
        layer: é…ç½®å±‚ï¼ˆé»˜è®¤ localï¼‰

    ç¤ºä¾‹:
        >>> config.set("database.pool_size", 10)
        [INFO] é…ç½®å·²æ›´æ–°: database.pool_size = 10

        >>> config.set("user.name", "å¼ ä¸‰")
        [INFO] é…ç½®å·²æ›´æ–°: user.name = å¼ ä¸‰
    """
```

##### 3. `get_project_config()` - è·å–é¡¹ç›®é…ç½®

```python
def get_project_config(self, project_name: str) -> Dict[str, Any]:
    """
    è·å–é¡¹ç›®é…ç½®

    å‚æ•°:
        project_name: é¡¹ç›®åç§°

    è¿”å›:
        é¡¹ç›®é…ç½®å­—å…¸

    ç¤ºä¾‹:
        >>> config = config.get_project_config("market_supervision")
        {
            "name": "å¸‚åœºç›‘ç®¡æ™ºèƒ½ä½“",
            "enabled": True,
            "database": {
                "type": "sqlite",
                "path": "04_Data_&_Resources/operators_database.db"
            },
            "ocr": {
                "engine": "baidu",
                "fallback": "paddle"
            }
        }
    """
```

##### 4. é…ç½®éªŒè¯

```python
def validate(self) -> List[str]:
    """
    éªŒè¯é…ç½®

    è¿”å›:
        é”™è¯¯åˆ—è¡¨ï¼ˆç©ºåˆ—è¡¨è¡¨ç¤ºéªŒè¯é€šè¿‡ï¼‰

    æ£€æŸ¥é¡¹:
    1. å¿…éœ€çš„é…ç½®å±‚æ˜¯å¦å­˜åœ¨
    2. é»˜è®¤é…ç½®æ˜¯å¦åŒ…å«å¿…éœ€çš„é”®
    3. é…ç½®æ ¼å¼æ˜¯å¦æ­£ç¡®
    """
```

##### 5. å¿«ç…§åŠŸèƒ½

```python
def create_snapshot(self, name: str = None) -> str:
    """åˆ›å»ºé…ç½®å¿«ç…§"""

def restore_snapshot(self, name: str) -> None:
    """æ¢å¤å¿«ç…§"""

def list_snapshots(self) -> List[str]:
    """åˆ—å‡ºæ‰€æœ‰å¿«ç…§"""
```

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: åˆå§‹åŒ–é…ç½®ä¸­å¿ƒ

```python
from config_center import ConfigCenter

# åˆå§‹åŒ–é…ç½®ä¸­å¿ƒ
config = ConfigCenter()

# åˆå§‹åŒ–é»˜è®¤é…ç½®
config.init_defaults()

# éªŒè¯é…ç½®
errors = config.validate()
if errors:
    print("é…ç½®é”™è¯¯:")
    for error in errors:
        print(f"  - {error}")
else:
    print("âœ… é…ç½®éªŒè¯é€šè¿‡")
```

#### ç¤ºä¾‹ 2: è¯»å–é…ç½®

```python
# è¯»å–ç®€å•é…ç½®
db_type = config.get("database.default_type")
print(f"æ•°æ®åº“ç±»å‹: {db_type}")

# è¯»å–åµŒå¥—é…ç½®
ocr_engine = config.get("market_supervision.ocr.engine")
print(f"OCR å¼•æ“: {ocr_engine}")

# è¯»å–é¡¹ç›®é…ç½®
market_config = config.get_project_config("market_supervision")
print(f"é¡¹ç›®åç§°: {market_config['name']}")
print(f"æ•°æ®åº“: {market_config['database']['path']}")
```

#### ç¤ºä¾‹ 3: ä¿®æ”¹é…ç½®

```python
# è®¾ç½®é…ç½®
config.set("database.pool_size", 10)
config.set("user.name", "å¼ ä¸‰")
config.set("user.email", "zhangsan@example.com")

# è¯»å–ç¡®è®¤
name = config.get("user.name")
print(f"ç”¨æˆ·å: {name}")
```

#### ç¤ºä¾‹ 4: é…ç½®å¿«ç…§

```python
# åˆ›å»ºå¿«ç…§
snapshot_path = config.create_snapshot("backup_20260116")
print(f"å¿«ç…§å·²ä¿å­˜: {snapshot_path}")

# åˆ—å‡ºå¿«ç…§
snapshots = config.list_snapshots()
print(f"å¯ç”¨å¿«ç…§: {snapshots}")

# æ¢å¤å¿«ç…§
config.restore_snapshot("backup_20260116")
print("å¿«ç…§å·²æ¢å¤")
```

### CLI å‘½ä»¤è¡Œæ¥å£

```bash
# åˆå§‹åŒ–é…ç½®
python 00_Agent_Library/config_center.py init

# è·å–é…ç½®
python 00_Agent_Library/config_center.py get --key database.default_type

# è®¾ç½®é…ç½®
python 00_Agent_Library/config_center.py set --key user.name --value "å¼ ä¸‰"

# åˆ—å‡ºé¡¹ç›®
python 00_Agent_Library/config_center.py list

# åˆ—å‡ºé¡¹ç›®é…ç½®
python 00_Agent_Library/config_center.py list --project market_supervision

# éªŒè¯é…ç½®
python 00_Agent_Library/config_center.py validate

# å¯¼å‡ºé…ç½®
python 00_Agent_Library/config_center.py export --output config_backup.yaml

# åˆ›å»ºå¿«ç…§
python 00_Agent_Library/config_center.py snapshot --name backup_20260116
```

### é…ç½®æ–‡ä»¶ç»“æ„

#### `defaults.yaml` - é»˜è®¤é…ç½®

```yaml
version: "1.0.0"

workspace:
  name: "Office Agent Workspace"
  root: "C:\Users\flyskyson\Office_Agent_Workspace"

database:
  default_type: "sqlite"
  sqlite_path: "04_Data_&_Resources/databases"
  pool_size: 5

logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "06_Learning_Journal/workspace.log"

paths:
  data: "04_Data_&_Resources"
  output: "05_Outputs"
  logs: "06_Learning_Journal"
  temp: "00_Agent_Library/temp"

features:
  mcp_servers:
    enabled: true
    auto_start: true
  skills:
    enabled: true
    auto_discover: true
```

#### `environment.yaml` - ç¯å¢ƒé…ç½®

```yaml
mode: "development"
debug: true
testing: false
```

#### `local.yaml` - æœ¬åœ°é…ç½®ï¼ˆä¸æäº¤ gitï¼‰

```yaml
user:
  name: ""
  email: ""

api_keys: {}
```

#### `projects/market_supervision.yaml` - é¡¹ç›®é…ç½®

```yaml
name: "å¸‚åœºç›‘ç®¡æ™ºèƒ½ä½“"
enabled: true

database:
  type: "sqlite"
  path: "04_Data_&_Resources/operators_database.db"

ocr:
  engine: "baidu"
  fallback: "paddle"

templates:
  path: "01_Active_Projects/market_supervision_agent/templates"
```

### ä¼˜åŠ¿å¯¹æ¯”

| ç‰¹æ€§ | Before (åˆ†æ•£é…ç½®) | After (é…ç½®ä¸­å¿ƒ) | æå‡ |
|------|-----------------|-----------------|------|
| é…ç½®æ–‡ä»¶æ•°é‡ | 10+ ä¸ª | 1 ä¸ªä¸­å¿ƒ | 90% â†“ |
| é…ç½®é‡å¤ | é«˜ | æ— ï¼ˆå•ä¸€æ•°æ®æºï¼‰ | ä¸€è‡´æ€§ â†‘ |
| ç¯å¢ƒåˆ‡æ¢ | æ‰‹åŠ¨æ”¹å¤šä¸ªæ–‡ä»¶ | æ”¹ 1 ä¸ª environment.yaml | æ•ˆç‡ â†‘ |
| é…ç½®éªŒè¯ | æ—  | è‡ªåŠ¨éªŒè¯ | å¯é æ€§ â†‘ |
| é…ç½®å†å² | æ—  Git è®°å½• | å¿«ç…§ç³»ç»Ÿ | å¯è¿½æº¯ â†‘ |

---

## 3. AgentSupervisor æ™ºèƒ½ä½“ç›‘ç£è€…

### ğŸ¯ åŠŸèƒ½æ¦‚è¿°

**æ–‡ä»¶ä½ç½®**: [00_Agent_Library/agent_supervisor.py](00_Agent_Library/agent_supervisor.py)

**æ ¸å¿ƒä»·å€¼**: æ™ºèƒ½ä½“åä½œèƒ½åŠ›ï¼Œå¤æ‚æµç¨‹è‡ªåŠ¨åŒ–

**æ¶æ„å‚è€ƒ**: [langgraph-ai/langgraph-supervisor-experiment](https://github.com/langgraph-ai/langgraph-supervisor-experiment)

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           AgentSupervisor - æ™ºèƒ½ä½“ç›‘ç£è€…                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚         è¯·æ±‚è·¯ç”±å™¨ (Router)                    â”‚      â”‚
â”‚  â”‚  æ ¹æ®å…³é”®è¯/æ„å›¾è‡ªåŠ¨è·¯ç”±åˆ°åˆé€‚çš„æ™ºèƒ½ä½“          â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                      â”‚                                  â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚         â–¼            â–¼            â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Market   â”‚  â”‚  Memory  â”‚  â”‚  File    â”‚            â”‚
â”‚  â”‚ Superv.  â”‚  â”‚  Agent   â”‚  â”‚ Organizerâ”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚
â”‚        â”‚             â”‚             â”‚                  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                      â”‚                                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚ å·¥ä½œæµç¼–æ’å™¨    â”‚                       â”‚
â”‚              â”‚ (Orchestrator) â”‚                       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                      â”‚                                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚ çŠ¶æ€ç®¡ç†å™¨      â”‚                       â”‚
â”‚              â”‚ (State Mgr)    â”‚                       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                      â”‚                                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚              â”‚ ç»Ÿè®¡ç›‘æ§å™¨      â”‚                       â”‚
â”‚              â”‚ (Stats)        â”‚                       â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç±»å’Œæ–¹æ³•

#### æ™ºèƒ½ä½“åŸºç±»

```python
class AgentType(Enum):
    """æ™ºèƒ½ä½“ç±»å‹æšä¸¾"""
    SUPERVISION = "market_supervision"    # å¸‚åœºç›‘ç®¡
    MEMORY = "memory"                      # è®°å¿†åŠ©æ‰‹
    FILE_ORGANIZER = "file_organizer"      # æ–‡ä»¶æ•´ç†
    NEWS_SCRAPER = "news_scraper"          # æ–°é—»çˆ¬è™«
    WORKFLOW_ENGINE = "workflow_engine"    # å·¥ä½œæµå¼•æ“


class AgentResponse:
    """æ™ºèƒ½ä½“å“åº”"""
    def __init__(
        self,
        success: bool,
        data: Any = None,
        error: str = None,
        next_agent: str = None  # æ”¯æŒæ™ºèƒ½ä½“é“¾å¼è°ƒç”¨
    ):
        self.success = success
        self.data = data
        self.error = error
        self.next_agent = next_agent
        self.timestamp = datetime.now()


class BaseAgent:
    """æ™ºèƒ½ä½“åŸºç±»"""
    def __init__(self, name: str, agent_type: AgentType):
        self.name = name
        self.agent_type = agent_type
        self.enabled = True  # æ”¯æŒå¯ç”¨/ç¦ç”¨
        self.state = {}      # æ™ºèƒ½ä½“çŠ¶æ€

    def execute(self, input_data: Dict[str, Any]) -> AgentResponse:
        """æ‰§è¡Œæ™ºèƒ½ä½“ä»»åŠ¡ï¼ˆå­ç±»å®ç°ï¼‰"""
        raise NotImplementedError
```

#### å…·ä½“æ™ºèƒ½ä½“å®ç°

##### 1. `MarketSupervisionAgent` - å¸‚åœºç›‘ç®¡æ™ºèƒ½ä½“

```python
class MarketSupervisionAgent(BaseAgent):
    """å¸‚åœºç›‘ç®¡æ™ºèƒ½ä½“"""

    def execute(self, input_data: Dict[str, Any]) -> AgentResponse:
        """
        æ”¯æŒçš„æ“ä½œ:
        - generate_application: ç”Ÿæˆç”³è¯·ä¹¦
        - list_operators: åˆ—å‡ºç»è¥æˆ·

        ç¤ºä¾‹:
            >>> agent.execute({
            ...     "action": "generate_application",
            ...     "operator_name": "å¼ ä¸‰",
            ...     "id_card": "123456789012345678"
            ... })
            AgentResponse(
                success=True,
                data={"message": "å·²ä¸º å¼ ä¸‰ å‡†å¤‡ç”³è¯·ä¹¦ç”Ÿæˆ"}
            )
        """
```

##### 2. `MemoryAgent` - è®°å¿†åŠ©æ‰‹

```python
class MemoryAgent(BaseAgent):
    """è®°å¿†åŠ©æ‰‹æ™ºèƒ½ä½“"""

    def execute(self, input_data: Dict[str, Any]) -> AgentResponse:
        """
        æ”¯æŒçš„æ“ä½œ:
        - add_note: æ·»åŠ ç¬”è®°
        - search: æœç´¢ç¬”è®°

        ç¤ºä¾‹:
            >>> agent.execute({
            ...     "action": "add_note",
            ...     "title": "å·¥ä½œè®°å½•",
            ...     "content": "å®Œæˆäº†å¸‚åœºç›‘ç®¡ä¼˜åŒ–"
            ... })
            AgentResponse(success=True, data={"note_id": 1})
        """
```

##### 3. `FileOrganizerAgent` - æ–‡ä»¶æ•´ç†å·¥å…·

```python
class FileOrganizerAgent(BaseAgent):
    """æ–‡ä»¶æ•´ç†å·¥å…·"""

    def execute(self, input_data: Dict[str, Any]) -> AgentResponse:
        """
        æ”¯æŒçš„æ“ä½œ:
        - scan: æ‰«ææ–‡ä»¶
        - organize: æ•´ç†æ–‡ä»¶
        """
```

#### `AgentSupervisor` - ç›‘ç£è€…ä¸»ç±»

```python
class AgentSupervisor:
    """
    æ™ºèƒ½ä½“ç›‘ç£è€… - åè°ƒå¤šä¸ª Agent åä½œ

    åŠŸèƒ½:
    1. è¯·æ±‚è·¯ç”± - å°†ç”¨æˆ·è¯·æ±‚è·¯ç”±åˆ°åˆé€‚çš„ Agent
    2. å·¥ä½œæµç¼–æ’ - åè°ƒå¤šä¸ª Agent æŒ‰é¡ºåºæ‰§è¡Œ
    3. çŠ¶æ€ç®¡ç† - ç»´æŠ¤å·¥ä½œæµçŠ¶æ€
    4. é”™è¯¯å¤„ç† - å¤„ç† Agent æ‰§è¡Œå¤±è´¥
    """
```

#### æ ¸å¿ƒæ–¹æ³•è¯¦è§£

##### 1. `route()` - è¯·æ±‚è·¯ç”±

```python
def route(self, user_request: str) -> str:
    """
    è·¯ç”±è¯·æ±‚åˆ°åˆé€‚çš„æ™ºèƒ½ä½“

    å‚æ•°:
        user_request: ç”¨æˆ·è¯·æ±‚

    è¿”å›:
        æ™ºèƒ½ä½“åç§°

    ç¤ºä¾‹:
        >>> supervisor.route("å¸®æˆ‘ç”Ÿæˆç”³è¯·ä¹¦")
        'market_supervision'

        >>> supervisor.route("è®°ä½è¿™ä¸ªä¿¡æ¯")
        'memory'

        >>> supervisor.route("æ•´ç†æ–‡ä»¶")
        'file_organizer'
    """
```

**è·¯ç”±è§„åˆ™**ï¼ˆåŸºäºå…³é”®è¯åŒ¹é…ï¼‰:

| æ™ºèƒ½ä½“ | å…³é”®è¯ |
|--------|--------|
| `market_supervision` | ç”³è¯·ä¹¦, ç»è¥æˆ·, ç”³è¯·, æ‰§ç…§, å¼€ä¸š, ä¸ªä½“å·¥å•†æˆ· |
| `memory` | ç¬”è®°, è®°ä½, å›å¿†, æœç´¢, è®°å½• |
| `file_organizer` | æ•´ç†, æ–‡ä»¶, å½’ç±», ç§»åŠ¨, å¤åˆ¶ |

##### 2. `execute_agent()` - æ‰§è¡Œå•ä¸ªæ™ºèƒ½ä½“

```python
def execute_agent(
    self,
    agent_name: str,
    input_data: Dict[str, Any]
) -> AgentResponse:
    """
    æ‰§è¡Œå•ä¸ªæ™ºèƒ½ä½“

    å‚æ•°:
        agent_name: æ™ºèƒ½ä½“åç§°
        input_data: è¾“å…¥æ•°æ®

    è¿”å›:
        AgentResponse

    ç¤ºä¾‹:
        >>> response = supervisor.execute_agent(
        ...     "memory",
        ...     {"action": "add_note", "title": "æµ‹è¯•", "content": "å†…å®¹"}
        ... )
        >>> response.success
        True
        >>> response.data
        {"note_id": 1, "message": "ç¬”è®°å·²ä¿å­˜"}
    """
```

##### 3. `orchestrate()` - å·¥ä½œæµç¼–æ’

```python
def orchestrate(
    self,
    workflow: List[Dict[str, Any]],
    initial_state: Dict[str, Any] = None
) -> Dict[str, Any]:
    """
    ç¼–æ’å¤šæ™ºèƒ½ä½“å·¥ä½œæµ

    å‚æ•°:
        workflow: å·¥ä½œæµå®šä¹‰
            [
                {"agent": "memory", "action": "search", "params": {...}},
                {"agent": "market_supervision", "action": "generate", "params": {...}}
            ]
        initial_state: åˆå§‹çŠ¶æ€

    è¿”å›:
        æœ€ç»ˆçŠ¶æ€å’Œç»“æœ

    ç‰¹æ€§:
    - çŠ¶æ€åœ¨å·¥ä½œæµä¸­ä¼ é€’
    - å¤±è´¥æ—¶ç«‹å³åœæ­¢
    - æ”¯æŒæ¡ä»¶è·³è½¬
    - è‡ªåŠ¨é”™è¯¯å¤„ç†
    """
```

**å·¥ä½œæµæ‰§è¡Œç¤ºä¾‹**:

```python
workflow = [
    {
        "agent": "file_organizer",
        "action": "scan",
        "params": {"path": "./materials"}
    },
    {
        "agent": "memory",
        "action": "search",
        "params": {"keyword": "å¼ ä¸‰"}
    },
    {
        "agent": "market_supervision",
        "action": "generate_application",
        "params": {
            "operator_name": "å¼ ä¸‰",
            "id_card": "123456789012345678"
        }
    }
]

result = supervisor.orchestrate(workflow)
# {
#     "success": True,
#     "final_state": {...},
#     "results": [...]
# }
```

##### 4. é¢„å®šä¹‰å·¥ä½œæµ

```python
# è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹
def workflow_license_application_complete(self, params: Dict) -> Dict:
    """
    å·¥ä½œæµæ­¥éª¤:
    1. FileOrganizer: æ‰«æè¯ä»¶ææ–™
    2. Memory: æ£€ç´¢å†å²è®°å½•
    3. MarketSupervision: ç”Ÿæˆç”³è¯·ä¹¦
    4. Memory: ä¿å­˜ç”³è¯·è®°å½•
    """

# æ¯æ—¥æ–°é—»æ‘˜è¦
def workflow_daily_news_summary(self, params: Dict) -> Dict:
    """
    å·¥ä½œæµæ­¥éª¤:
    1. NewsScraper: è·å–æ–°é—»
    2. Memory: å­˜å‚¨æ–°é—»
    3. Memory: ç”Ÿæˆæ—¥æŠ¥
    """
```

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: å•æ™ºèƒ½ä½“æ‰§è¡Œ

```python
from agent_supervisor import AgentSupervisor

# åˆå§‹åŒ–ç›‘ç£è€…
supervisor = AgentSupervisor()

# æ‰§è¡Œè®°å¿†åŠ©æ‰‹
response = supervisor.execute_agent("memory", {
    "action": "add_note",
    "title": "ä»Šæ—¥å·¥ä½œ",
    "content": "å®Œæˆäº† AgentSupervisor å¼€å‘",
    "category": "å·¥ä½œ"
})

if response.success:
    print(f"âœ… {response.data['message']}")
    print(f"ç¬”è®° ID: {response.data['note_id']}")
else:
    print(f"âŒ {response.error}")
```

#### ç¤ºä¾‹ 2: å·¥ä½œæµæ‰§è¡Œ

```python
# å®šä¹‰å·¥ä½œæµ
workflow = [
    {
        "agent": "memory",
        "action": "add_note",
        "params": {
            "title": "è¯ç…§ç”³è¯·å‡†å¤‡",
            "content": "ä¸ºå¼ ä¸‰å‡†å¤‡è¯ç…§ç”³è¯·ææ–™",
            "category": "è¯ç…§"
        }
    },
    {
        "agent": "market_supervision",
        "action": "generate_application",
        "params": {
            "operator_name": "å¼ ä¸‰",
            "id_card": "123456789012345678",
            "business_name": "å¼ ä¸‰å•†é“º"
        }
    }
]

# æ‰§è¡Œå·¥ä½œæµ
result = supervisor.orchestrate(workflow)

if result["success"]:
    print("âœ… å·¥ä½œæµæ‰§è¡ŒæˆåŠŸ")
    print(f"å®Œæˆæ­¥éª¤: {len(result['results'])}")
else:
    print(f"âŒ å·¥ä½œæµå¤±è´¥: {result['error']}")
```

#### ç¤ºä¾‹ 3: é¢„å®šä¹‰å·¥ä½œæµ

```python
# ä½¿ç”¨é¢„å®šä¹‰çš„è¯ç…§ç”³è¯·å·¥ä½œæµ
result = supervisor.workflow_license_application_complete({
    "operator_name": "å¼ ä¸‰",
    "id_card": "123456789012345678",
    "business_name": "å¼ ä¸‰å•†é“º",
    "business_address": "åŒ—äº¬å¸‚æœé˜³åŒºxxx",
    "material_path": "./materials"
})

if result["success"]:
    print("âœ… è¯ç…§ç”³è¯·æµç¨‹å®Œæˆ")
    print(f"æœ€ç»ˆçŠ¶æ€: {result['final_state']}")
```

#### ç¤ºä¾‹ 4: ç»Ÿè®¡ç›‘æ§

```python
# è·å–ç»Ÿè®¡ä¿¡æ¯
stats = supervisor.get_stats()

print(f"æ€»è¯·æ±‚æ•°: {stats['requests']['total']}")
print(f"æˆåŠŸç‡: {stats['requests']['success_rate']:.1%}")
print("\næ™ºèƒ½ä½“è°ƒç”¨ç»Ÿè®¡:")
for agent_name, agent_stats in stats['agents'].items():
    status = "âœ…" if agent_stats['enabled'] else "âŒ"
    print(f"  {status} {agent_name}: {agent_stats['calls']} æ¬¡")

# å¯ç”¨/ç¦ç”¨æ™ºèƒ½ä½“
supervisor.disable_agent("file_organizer")
supervisor.enable_agent("file_organizer")
```

### æµ‹è¯•éªŒè¯

```bash
# è¿è¡Œæµ‹è¯•
python 00_Agent_Library/agent_supervisor.py
```

**é¢„æœŸè¾“å‡º**:
```
============================================================
AgentSupervisor - æ™ºèƒ½ä½“ç›‘ç£è€…
============================================================
[INFO] AgentSupervisor åˆå§‹åŒ–å®Œæˆ
[INFO] å·²æ³¨å†Œ 3 ä¸ªæ™ºèƒ½ä½“

[å·²æ³¨å†Œçš„æ™ºèƒ½ä½“]
  âœ… market_supervision: å¸‚åœºç›‘ç®¡æ™ºèƒ½ä½“
  âœ… memory: è®°å¿†åŠ©æ‰‹
  âœ… file_organizer: æ–‡ä»¶æ•´ç†å·¥å…·

[ç¤ºä¾‹ 1] å•æ™ºèƒ½ä½“æ‰§è¡Œ
  ç»“æœ: {'success': True, 'data': {'note_id': 2, 'message': 'ç¬”è®°å·²ä¿å­˜'}}

[ç¤ºä¾‹ 2] å·¥ä½œæµæ‰§è¡Œ
[å·¥ä½œæµ] æ‰§è¡Œ 4 æ­¥å·¥ä½œæµ
  [1/4] file_organizer.scan
    âœ… æˆåŠŸ
  [2/4] memory.search
    âœ… æˆåŠŸ
  [3/4] market_supervision.generate_application
    âœ… æˆåŠŸ
  [4/4] memory.add_note
    âœ… æˆåŠŸ
[å·¥ä½œæµ] âœ… å®Œæˆ

[ç»Ÿè®¡ä¿¡æ¯]
  æ€»è¯·æ±‚æ•°: 5
  æˆåŠŸç‡: 100.0%
  æ™ºèƒ½ä½“è°ƒç”¨:
    - market_supervision: 1 æ¬¡
    - memory: 3 æ¬¡
    - file_organizer: 1 æ¬¡

============================================================
âœ… AgentSupervisor æµ‹è¯•å®Œæˆ
============================================================
```

### æ¶æ„ä¼˜åŠ¿

| ç‰¹æ€§ | Before (ç‹¬ç«‹æ™ºèƒ½ä½“) | After (Supervisor) | æå‡ |
|------|-------------------|-------------------|------|
| æ™ºèƒ½ä½“åä½œ | æ— ï¼ˆæ‰‹åŠ¨åè°ƒï¼‰ | è‡ªåŠ¨ç¼–æ’ | æ•ˆç‡ â†‘â†‘ |
| çŠ¶æ€ç®¡ç† | åˆ†æ•£ | ç»Ÿä¸€ | ä¸€è‡´æ€§ â†‘ |
| é”™è¯¯å¤„ç† | å„è‡ªå¤„ç† | é›†ä¸­å¤„ç† | å¯é æ€§ â†‘ |
| å¯æ‰©å±•æ€§ | ä½ | é«˜ï¼ˆæ’ä»¶å¼ï¼‰ | æ‰©å±•æ€§ â†‘ |
| å·¥ä½œæµå¤ç”¨ | æ—  | æ¨¡æ¿åŒ– | æ•ˆç‡ â†‘â†‘ |

---

## 4. å·¥ä½œæµæ¨¡æ¿ç³»ç»Ÿ

### ğŸ¯ åŠŸèƒ½æ¦‚è¿°

**æ–‡ä»¶ä½ç½®**: [00_Agent_Library/workflow_templates.py](00_Agent_Library/workflow_templates.py)

**æ ¸å¿ƒä»·å€¼**: å¯å¤ç”¨å·¥ä½œæµï¼Œå‡å°‘ 80% é‡å¤ä»£ç 

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Workflow Templates - å·¥ä½œæµæ¨¡æ¿ç³»ç»Ÿ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  å†…ç½®æ¨¡æ¿åº“ (Built-in Templates):                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ 1. LicenseApplicationTemplate               â”‚        â”‚
â”‚  â”‚    - è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹                        â”‚        â”‚
â”‚  â”‚    - 4 ä¸ªæ­¥éª¤, 5 ä¸ªå‚æ•°                      â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ 2. DailyNewsSummaryTemplate                 â”‚        â”‚
â”‚  â”‚    - æ¯æ—¥æ–°é—»æ‘˜è¦                           â”‚        â”‚
â”‚  â”‚    - 3 ä¸ªæ­¥éª¤, 3 ä¸ªå‚æ•°                      â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ 3. FileOrganizeTemplate                     â”‚        â”‚
â”‚  â”‚    - æ™ºèƒ½æ–‡ä»¶æ•´ç†                           â”‚        â”‚
â”‚  â”‚    - 3 ä¸ªæ­¥éª¤, 4 ä¸ªå‚æ•°                      â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚ 4. KnowledgeIndexTemplate                   â”‚        â”‚
â”‚  â”‚    - çŸ¥è¯†åº“ç´¢å¼•æ›´æ–°                         â”‚        â”‚
â”‚  â”‚    - 3 ä¸ªæ­¥éª¤, 2 ä¸ªå‚æ•°                      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                        â”‚                                â”‚
â”‚                        â–¼                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚     WorkflowTemplateManager                 â”‚        â”‚
â”‚  â”‚     - æ¨¡æ¿æ³¨å†Œå’Œå‘ç°                        â”‚        â”‚
â”‚  â”‚     - å‚æ•°éªŒè¯                              â”‚        â”‚
â”‚  â”‚     - å®ä¾‹åŒ–ï¼ˆå‚æ•°æ›¿æ¢ï¼‰                    â”‚        â”‚
â”‚  â”‚     - å¯¼å…¥/å¯¼å‡º                             â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                      â”‚                                  â”‚
â”‚                      â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚      å®ä¾‹åŒ–çš„å·¥ä½œæµ (Instantiated)           â”‚        â”‚
â”‚  â”‚  [                                           â”‚        â”‚
â”‚  â”‚    {"agent": "memory", "action": "search"},  â”‚        â”‚
â”‚  â”‚    {"agent": "market_supervision", ...}     â”‚        â”‚
â”‚  â”‚  ]                                           â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                      â”‚                                  â”‚
â”‚                      â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚      AgentSupervisor.orchestrate()          â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç±»å’Œæ–¹æ³•

#### `WorkflowTemplate` - å·¥ä½œæµæ¨¡æ¿åŸºç±»

```python
class WorkflowTemplate:
    """
    å·¥ä½œæµæ¨¡æ¿åŸºç±»

    å±æ€§:
        name: æ¨¡æ¿åç§°
        description: æè¿°
        category: åˆ†ç±»
        version: ç‰ˆæœ¬
        steps: å·¥ä½œæµæ­¥éª¤åˆ—è¡¨
        parameters: å‚æ•°å®šä¹‰
    """
```

#### æ ¸å¿ƒæ–¹æ³•è¯¦è§£

##### 1. `add_step()` - æ·»åŠ å·¥ä½œæµæ­¥éª¤

```python
def add_step(
    self,
    agent: str,
    action: str,
    params: Dict[str, Any] = None,
    condition: str = None
):
    """
    æ·»åŠ å·¥ä½œæµæ­¥éª¤

    å‚æ•°:
        agent: æ™ºèƒ½ä½“åç§°
        action: æ“ä½œåç§°
        params: å‚æ•°ï¼ˆæ”¯æŒå‚æ•°å¼•ç”¨ ${param_name}ï¼‰
        condition: æ‰§è¡Œæ¡ä»¶ï¼ˆå¯é€‰ï¼‰

    ç¤ºä¾‹:
        >>> template.add_step(
        ...     "memory",
        ...     "add_note",
        ...     params={
        ...         "title": "${operator_name}",
        ...         "content": "èº«ä»½è¯: ${id_card}"
        ...     }
        ... )
    """
```

##### 2. `add_parameter()` - æ·»åŠ å‚æ•°å®šä¹‰

```python
def add_parameter(
    self,
    name: str,
    type: str,
    default: Any = None,
    required: bool = False,
    description: str = ""
):
    """
    æ·»åŠ å‚æ•°å®šä¹‰

    å‚æ•°:
        name: å‚æ•°å
        type: å‚æ•°ç±»å‹ï¼ˆstring, integer, boolean, list, dictï¼‰
        default: é»˜è®¤å€¼
        required: æ˜¯å¦å¿…éœ€
        description: æè¿°

    ç¤ºä¾‹:
        >>> template.add_parameter(
        ...     "operator_name",
        ...     "string",
        ...     required=True,
        ...     description="ç»è¥è€…å§“å"
        ... )
    """
```

##### 3. `save()` - ä¿å­˜æ¨¡æ¿

```python
def save(self, directory: Path) -> Path:
    """
    ä¿å­˜åˆ°æ–‡ä»¶ (YAML æ ¼å¼)

    è¿”å›:
        ä¿å­˜çš„æ–‡ä»¶è·¯å¾„
    """
```

#### `WorkflowTemplateManager` - æ¨¡æ¿ç®¡ç†å™¨

```python
class WorkflowTemplateManager:
    """
    å·¥ä½œæµæ¨¡æ¿ç®¡ç†å™¨

    åŠŸèƒ½:
    1. æ¨¡æ¿æ³¨å†Œå’Œå‘ç°
    2. æ¨¡æ¿å‚æ•°éªŒè¯
    3. æ¨¡æ¿å®ä¾‹åŒ–
    4. æ¨¡æ¿å¯¼å‡ºå’Œå¯¼å…¥
    """
```

#### æ ¸å¿ƒæ–¹æ³•è¯¦è§£

##### 1. `register()` - æ³¨å†Œæ¨¡æ¿

```python
def register(self, template: WorkflowTemplate):
    """
    æ³¨å†Œæ¨¡æ¿

    å‚æ•°:
        template: WorkflowTemplate å®ä¾‹

    ç¤ºä¾‹:
        >>> manager.register(LicenseApplicationTemplate())
        [INFO] æ³¨å†Œæ¨¡æ¿: è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹
    """
```

##### 2. `get()` - è·å–æ¨¡æ¿

```python
def get(self, name: str) -> Optional[WorkflowTemplate]:
    """
    è·å–æ¨¡æ¿

    å‚æ•°:
        name: æ¨¡æ¿åç§°

    è¿”å›:
        WorkflowTemplate å®ä¾‹æˆ– None

    ç¤ºä¾‹:
        >>> template = manager.get("è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹")
        >>> template.name
        'è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹'
    """
```

##### 3. `instantiate()` - å®ä¾‹åŒ–æ¨¡æ¿

```python
def instantiate(
    self,
    template_name: str,
    parameters: Dict[str, Any]
) -> List[Dict[str, Any]]:
    """
    å®ä¾‹åŒ–æ¨¡æ¿ï¼ˆæ›¿æ¢å‚æ•°å¼•ç”¨ï¼‰

    å‚æ•°:
        template_name: æ¨¡æ¿åç§°
        parameters: å‚æ•°å€¼

    è¿”å›:
        å®ä¾‹åŒ–åçš„å·¥ä½œæµæ­¥éª¤åˆ—è¡¨

    ç‰¹æ€§:
    - éªŒè¯å¿…éœ€å‚æ•°
    - æ›¿æ¢ ${param_name} å¼•ç”¨
    - æ”¯æŒåµŒå¥—å‚æ•°è®¿é—®
    - æ”¯æŒè¡¨è¾¾å¼ï¼ˆå¦‚ datetime.now()ï¼‰

    ç¤ºä¾‹:
        >>> steps = manager.instantiate(
        ...     "è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹",
        ...     {
        ...         "operator_name": "å¼ ä¸‰",
        ...         "id_card": "123456789012345678",
        ...         "business_name": "å¼ ä¸‰å•†é“º"
        ...     }
        ... )
        >>> steps[2]["params"]["operator_name"]
        'å¼ ä¸‰'
    """
```

**å‚æ•°æ›¿æ¢åŸç†**:
```python
# æ¨¡æ¿å®šä¹‰:
params = {
    "title": "${operator_name}",
    "content": "èº«ä»½è¯: ${id_card}"
}

# å®ä¾‹åŒ–å‚æ•°:
parameters = {
    "operator_name": "å¼ ä¸‰",
    "id_card": "123456"
}

# æ›¿æ¢å:
{
    "title": "å¼ ä¸‰",
    "content": "èº«ä»½è¯: 123456"
}
```

### é¢„å®šä¹‰æ¨¡æ¿è¯¦è§£

#### 1. `LicenseApplicationTemplate` - è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹

**åˆ†ç±»**: è¯ç…§ç®¡ç†
**æ­¥éª¤æ•°**: 4
**å‚æ•°æ•°**: 5

**å‚æ•°å®šä¹‰**:
```python
{
    "operator_name": {"type": "string", "required": True},
    "id_card": {"type": "string", "required": True},
    "material_path": {"type": "string", "default": "."},
    "business_name": {"type": "string", "default": ""},
    "business_address": {"type": "string", "default": ""}
}
```

**å·¥ä½œæµæ­¥éª¤**:
```yaml
1:
  agent: file_organizer
  action: scan
  params:
    path: "${material_path}"

2:
  agent: memory
  action: search
  params:
    keyword: "${operator_name}"

3:
  agent: market_supervision
  action: generate_application
  params:
    operator_name: "${operator_name}"
    id_card: "${id_card}"
    business_name: "${business_name}"
    business_address: "${business_address}"

4:
  agent: memory
  action: add_note
  params:
    title: "ç”³è¯·è®°å½•: ${operator_name}"
    content: "èº«ä»½è¯: ${id_card}, å•†é“º: ${business_name}"
    category: "è¯ç…§ç”³è¯·"
```

#### 2. `DailyNewsSummaryTemplate` - æ¯æ—¥æ–°é—»æ‘˜è¦

**åˆ†ç±»**: èµ„è®¯ç®¡ç†
**æ­¥éª¤æ•°**: 3
**å‚æ•°æ•°**: 3

**å‚æ•°å®šä¹‰**:
```python
{
    "platforms": {
        "type": "list",
        "default": ["weibo", "zhihu", "bilibili"]
    },
    "count": {"type": "integer", "default": 20},
    "keywords": {"type": "list", "default": []}
}
```

**å·¥ä½œæµæ­¥éª¤**:
```yaml
1:
  agent: news_scraper
  action: fetch
  params:
    platforms: "${platforms}"
    count: "${count}"

2:
  agent: memory
  action: search
  params:
    keyword: "${keywords[0] if keywords else ''}"

3:
  agent: memory
  action: add_note
  params:
    title: "æ–°é—»æ—¥æŠ¥ ${datetime.now().strftime('%Y-%m-%d')}"
    content: "ä»Šæ—¥çƒ­ç‚¹æ–°é—»æ‘˜è¦"
    category: "æ–°é—»"
```

#### 3. `FileOrganizeTemplate` - æ™ºèƒ½æ–‡ä»¶æ•´ç†

**åˆ†ç±»**: æ–‡ä»¶ç®¡ç†
**æ­¥éª¤æ•°**: 3
**å‚æ•°æ•°**: 4

**å‚æ•°å®šä¹‰**:
```python
{
    "source_path": {"type": "string", "required": True},
    "target_path": {"type": "string", "required": True},
    "rules": {"type": "dict", "default": {}},
    "create_backup": {"type": "boolean", "default": True}
}
```

#### 4. `KnowledgeIndexTemplate` - çŸ¥è¯†åº“ç´¢å¼•æ›´æ–°

**åˆ†ç±»**: çŸ¥è¯†ç®¡ç†
**æ­¥éª¤æ•°**: 3
**å‚æ•°æ•°**: 2

**å‚æ•°å®šä¹‰**:
```python
{
    "notes_path": {"type": "string", "required": True},
    "index_type": {"type": "string", "default": "vector"}
}
```

### ä½¿ç”¨ç¤ºä¾‹

#### ç¤ºä¾‹ 1: åˆå§‹åŒ–æ¨¡æ¿ç®¡ç†å™¨

```python
from workflow_templates import WorkflowTemplateManager

# åˆå§‹åŒ–ç®¡ç†å™¨
manager = WorkflowTemplateManager()

# åˆ—å‡ºæ‰€æœ‰åˆ†ç±»
categories = manager.list_categories()
print(f"åˆ†ç±»: {categories}")
# ['è¯ç…§ç®¡ç†', 'èµ„è®¯ç®¡ç†', 'æ–‡ä»¶ç®¡ç†', 'çŸ¥è¯†ç®¡ç†']

# åˆ—å‡ºæ‰€æœ‰æ¨¡æ¿
templates = manager.list_templates()
for template in templates:
    print(f"- {template.name}: {len(template.steps)} æ­¥")
```

#### ç¤ºä¾‹ 2: å®ä¾‹åŒ–æ¨¡æ¿

```python
# å®ä¾‹åŒ–è¯ç…§ç”³è¯·æ¨¡æ¿
steps = manager.instantiate(
    "è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹",
    {
        "operator_name": "å¼ ä¸‰",
        "id_card": "123456789012345678",
        "business_name": "å¼ ä¸‰å•†é“º",
        "business_address": "åŒ—äº¬å¸‚æœé˜³åŒºxxx"
    }
)

# æŸ¥çœ‹ç”Ÿæˆçš„æ­¥éª¤
for i, step in enumerate(steps, 1):
    print(f"[{i}] {step['agent']}.{step['action']}")
    print(f"    å‚æ•°: {step['params']}")

# è¾“å‡º:
# [1] file_organizer.scan
#     å‚æ•°: {'path': '.'}
# [2] memory.search
#     å‚æ•°: {'keyword': 'å¼ ä¸‰'}
# [3] market_supervision.generate_application
#     å‚æ•°: {'operator_name': 'å¼ ä¸‰', 'id_card': '123456789012345678', ...}
# [4] memory.add_note
#     å‚æ•°: {'title': 'ç”³è¯·è®°å½•: å¼ ä¸‰', ...}
```

#### ç¤ºä¾‹ 3: æ‰§è¡Œå·¥ä½œæµ

```python
from agent_supervisor import AgentSupervisor

# åˆå§‹åŒ–ç›‘ç£è€…
supervisor = AgentSupervisor()

# å®ä¾‹åŒ–æ¨¡æ¿
steps = manager.instantiate("è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹", {
    "operator_name": "å¼ ä¸‰",
    "id_card": "123456789012345678"
})

# æ‰§è¡Œå·¥ä½œæµ
result = supervisor.orchestrate(steps)

if result["success"]:
    print("âœ… å·¥ä½œæµæ‰§è¡ŒæˆåŠŸ")
    print(f"å®Œæˆæ­¥éª¤: {len(result['results'])}")
else:
    print(f"âŒ å·¥ä½œæµå¤±è´¥: {result['error']}")
```

#### ç¤ºä¾‹ 4: åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿

```python
from workflow_templates import WorkflowTemplate

# åˆ›å»ºæ–°æ¨¡æ¿
template = WorkflowTemplate(
    name="æˆ‘çš„è‡ªå®šä¹‰å·¥ä½œæµ",
    description="è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å·¥ä½œæµ",
    category="è‡ªå®šä¹‰",
    version="1.0.0"
)

# æ·»åŠ å‚æ•°
template.add_parameter("user_name", "string", required=True)
template.add_parameter("action_type", "string", default="create")

# æ·»åŠ æ­¥éª¤
template.add_step(
    "memory",
    "add_note",
    params={
        "title": "æ“ä½œè®°å½•: ${user_name}",
        "content": "æ‰§è¡Œäº† ${action_type} æ“ä½œ"
    }
)

# ä¿å­˜æ¨¡æ¿
template.save(manager.templates_dir)

# æ³¨å†Œåˆ°ç®¡ç†å™¨
manager.register(template)
```

#### ç¤ºä¾‹ 5: å¯¼å‡ºå’Œå¯¼å…¥æ¨¡æ¿

```python
# å¯¼å‡ºæ¨¡æ¿
template = manager.get("è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹")
output_path = template.save(Path("./my_templates"))
print(f"æ¨¡æ¿å·²å¯¼å‡º: {output_path}")

# å¯¼å…¥æ¨¡æ¿ï¼ˆè‡ªåŠ¨ä» templates_dir åŠ è½½ï¼‰
manager = WorkflowTemplateManager()  # è‡ªåŠ¨åŠ è½½æ‰€æœ‰ YAML æ¨¡æ¿
```

### YAML æ ¼å¼ç¤ºä¾‹

#### æ¨¡æ¿æ–‡ä»¶æ ¼å¼

```yaml
# license_application_complete.yaml
name: è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹
description: ä»ææ–™æ‰«æåˆ°ç”³è¯·è¡¨ç”Ÿæˆçš„å®Œæ•´æµç¨‹
category: è¯ç…§ç®¡ç†
version: 1.0.0
created_at: 2026-01-16T10:00:00

parameters:
  operator_name:
    type: string
    required: true
    description: ç»è¥è€…å§“å

  id_card:
    type: string
    required: true
    description: èº«ä»½è¯å·

  business_name:
    type: string
    default: ""
    description: å•†é“ºåç§°

steps:
  - agent: file_organizer
    action: scan
    params:
      path: "${material_path}"

  - agent: memory
    action: search
    params:
      keyword: "${operator_name}"

  - agent: market_supervision
    action: generate_application
    params:
      operator_name: "${operator_name}"
      id_card: "${id_card}"
      business_name: "${business_name}"
```

### æµ‹è¯•éªŒè¯

```bash
# è¿è¡Œæµ‹è¯•
python 00_Agent_Library/workflow_templates.py
```

**é¢„æœŸè¾“å‡º**:
```
============================================================
å·¥ä½œæµæ¨¡æ¿ç®¡ç†å™¨
============================================================
[INFO] æ³¨å†Œæ¨¡æ¿: è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹
[INFO] æ³¨å†Œæ¨¡æ¿: æ¯æ—¥æ–°é—»æ‘˜è¦
[INFO] æ³¨å†Œæ¨¡æ¿: æ™ºèƒ½æ–‡ä»¶æ•´ç†
[INFO] æ³¨å†Œæ¨¡æ¿: çŸ¥è¯†åº“ç´¢å¼•æ›´æ–°
[INFO] å·¥ä½œæµæ¨¡æ¿ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ
[INFO] å·²åŠ è½½ 4 ä¸ªæ¨¡æ¿

[æ¨¡æ¿åˆ†ç±»]
  - æ–‡ä»¶ç®¡ç†
  - çŸ¥è¯†ç®¡ç†
  - è¯ç…§ç®¡ç†
  - èµ„è®¯ç®¡ç†

[æ‰€æœ‰æ¨¡æ¿]
  ğŸ“‹ æ™ºèƒ½æ–‡ä»¶æ•´ç†
     æè¿°: æŒ‰ç±»å‹å’Œæ—¥æœŸæ•´ç†æ–‡ä»¶
     åˆ†ç±»: æ–‡ä»¶ç®¡ç†
     æ­¥éª¤æ•°: 3

  ğŸ“‹ æ¯æ—¥æ–°é—»æ‘˜è¦
     æè¿°: è·å–çƒ­ç‚¹æ–°é—»å¹¶ç”Ÿæˆæ—¥æŠ¥
     åˆ†ç±»: èµ„è®¯ç®¡ç†
     æ­¥éª¤æ•°: 3

  ğŸ“‹ çŸ¥è¯†åº“ç´¢å¼•æ›´æ–°
     æè¿°: æ‰«æç¬”è®°å¹¶æ›´æ–°å‘é‡ç´¢å¼•
     åˆ†ç±»: çŸ¥è¯†ç®¡ç†
     æ­¥éª¤æ•°: 3

  ğŸ“‹ è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹
     æè¿°: ä»ææ–™æ‰«æåˆ°ç”³è¯·è¡¨ç”Ÿæˆçš„å®Œæ•´æµç¨‹
     åˆ†ç±»: è¯ç…§ç®¡ç†
     æ­¥éª¤æ•°: 4
     å‚æ•°:
       - operator_name: å¿…éœ€
       - id_card: å¿…éœ€
       - material_path: å¯é€‰ (é»˜è®¤: .)
       - business_name: å¯é€‰
       - business_address: å¯é€‰

[ç¤ºä¾‹] å®ä¾‹åŒ– 'è¯ç…§ç”³è¯·å®Œæ•´æµç¨‹' æ¨¡æ¿
  ç”Ÿæˆäº† 4 æ­¥å·¥ä½œæµ:
    [1] file_organizer.scan
        å‚æ•°: {"path": "."}
    [2] memory.search
        å‚æ•°: {"keyword": "å¼ ä¸‰"}
    [3] market_supervision.generate_application
        å‚æ•°: {"operator_name": "å¼ ä¸‰", "id_card": "123456789012345678", ...}
    [4] memory.add_note
        å‚æ•°: {"title": "ç”³è¯·è®°å½•: ${operator_name}", ...}

[ä¿å­˜æ¨¡æ¿]
[INFO] å·²ä¿å­˜ 4 ä¸ªæ¨¡æ¿

============================================================
âœ… å·¥ä½œæµæ¨¡æ¿ç®¡ç†å™¨æµ‹è¯•å®Œæˆ
============================================================
```

### ä¼˜åŠ¿å¯¹æ¯”

| ç‰¹æ€§ | Before (æ‰‹åŠ¨ç¼–å†™) | After (æ¨¡æ¿ç³»ç»Ÿ) | æå‡ |
|------|------------------|-----------------|------|
| å·¥ä½œæµå¼€å‘æ—¶é—´ | 30 åˆ†é’Ÿ | 3 åˆ†é’Ÿ | 90% â†“ |
| ä»£ç å¤ç”¨ç‡ | 0% | 80%+ | âˆ |
| å‚æ•°éªŒè¯ | æ‰‹åŠ¨ | è‡ªåŠ¨ | å¯é æ€§ â†‘ |
| ç»´æŠ¤æˆæœ¬ | é«˜ | ä½ | 60% â†“ |
| å­¦ä¹ æ›²çº¿ | é™¡å³­ | å¹³ç¼“ | æ˜“ç”¨æ€§ â†‘ |

---

## ğŸ¯ æ€»ç»“

### å››å¤§æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | ä»£ç è¡Œæ•° | å¼€å‘æ—¶é—´ | æµ‹è¯•çŠ¶æ€ | æ ¸å¿ƒä»·å€¼ |
|------|---------|---------|---------|---------|
| **SQLite MCP** | ~500 è¡Œ | 10 åˆ†é’Ÿ | âœ… é€šè¿‡ | ç»Ÿä¸€æ•°æ®å±‚ |
| **ConfigCenter** | ~600 è¡Œ | 8 åˆ†é’Ÿ | âœ… é€šè¿‡ | å•ä¸€é…ç½®æº |
| **AgentSupervisor** | ~600 è¡Œ | 8 åˆ†é’Ÿ | âœ… é€šè¿‡ | æ™ºèƒ½ä½“åä½œ |
| **Workflow Templates** | ~400 è¡Œ | 4 åˆ†é’Ÿ | âœ… é€šè¿‡ | å·¥ä½œæµå¤ç”¨ |

### æ•´ä½“æ¶æ„ä¼˜åŠ¿

```
Before (ç‹¬ç«‹åˆ†æ•£):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Market  â”‚  â”‚ Memory  â”‚  â”‚  File   â”‚
â”‚   DB    â”‚  â”‚ChromaDB â”‚  â”‚  JSON   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“            â†“            â†“
åˆ†æ•£é…ç½®ï¼Œå„è‡ªä¸ºæ”¿ï¼Œæ— åä½œ

After (ç»Ÿä¸€è”é‚¦):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        AgentSupervisor              â”‚
â”‚  (åè°ƒ + è·¯ç”± + ç¼–æ’ + ç›‘æ§)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼          â–¼          â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Market â”‚ â”‚ Memory â”‚ â”‚  File  â”‚ â”‚ News   â”‚
â”‚  MCP   â”‚ â”‚  MCP   â”‚ â”‚  MCP   â”‚ â”‚  MCP   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ConfigCenter    â”‚
         â”‚ (ç»Ÿä¸€é…ç½®)       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»Ÿä¸€é…ç½®ï¼Œæ•°æ®å…±äº«ï¼Œæ™ºèƒ½åä½œ
```

### ä¸‹ä¸€æ­¥å»ºè®®

1. âœ… **ç«‹å³ä½¿ç”¨**: å››ä¸ªåŠŸèƒ½å·²å…¨éƒ¨æµ‹è¯•é€šè¿‡ï¼Œå¯ç›´æ¥ä½¿ç”¨
2. ğŸ”² **æ‰©å±• MCP æœåŠ¡å™¨**: é›†æˆæ›´å¤šç¤¾åŒº MCP æœåŠ¡å™¨
3. ğŸ”² **ä¸°å¯Œæ¨¡æ¿åº“**: æ·»åŠ æ›´å¤šé¢„å®šä¹‰å·¥ä½œæµæ¨¡æ¿
4. ğŸ”² **å¯è§†åŒ–ç•Œé¢**: å¼€å‘ GUI ç®¡ç†ç•Œé¢

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2026-01-16
**ç»´æŠ¤è€…**: Claude Code (GLM-4.7)

**ç›¸å…³æ–‡æ¡£**:
- [instant_execution_report.md](instant_execution_report_20260116.md) - æ‰§è¡ŒæŠ¥å‘Š
- [CLAUDE.md](../../CLAUDE.md) - é¡¹ç›®é…ç½®
- [COMPLETE_SYSTEM_GUIDE.md](../../COMPLETE_SYSTEM_GUIDE.md) - å®Œæ•´ç³»ç»ŸæŒ‡å—
