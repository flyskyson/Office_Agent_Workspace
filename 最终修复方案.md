# Python 语法高亮最终修复方案

## 问题确认
- ✅ Python扩展已安装
- ✅ Pylance扩展已安装
- ✅ 解释器正确 (Python 3.12.9)
- ❌ 所有文件夹都没有语法高亮

## 诊断步骤

### 步骤 1: 检查文件语言模式
打开任意 `.py` 文件，看 VSCode 窗口右下角，应该显示 "Python"

**如果不显示 Python:**
1. 点击右下角的语言标识
2. 搜索并选择 "Python"

### 步骤 2: 检查 VSCode 主题
1. 按 `Ctrl+Shift+P`
2. 输入 "Preferences: Color Theme"
3. 选择一个深色或浅色主题（不要选 "Default High Contrast"）
4. 推荐主题：
   - "Dark+ (default dark)"
   - "Light+ (default light)"
   - "Monokai"

### 步骤 3: 强制重启 Pylance
1. 按 `Ctrl+Shift+P`
2. 输入 "Pylance: Restart Server"
3. 按 Enter
4. 等待 5-10 秒

### 步骤 4: 检查输出面板
1. 按 `Ctrl+Shift+U` (打开输出)
2. 在下拉菜单中选择 "Pylance"
3. 查看是否有红色错误信息

### 步骤 5: 重置 Python 扩展
1. 按 `Ctrl+Shift+X` (打开扩展)
2. 搜索 "Python"
3. 点击 `ms-python.python` 右侧的小齿轮 ⚙️
4. 选择 "Disable" (禁用)
5. 等待 3 秒
6. 再次点击齿轮，选择 "Enable" (启用)
7. 点击 "Reload Required" 按钮

### 步骤 6: 重置 Pylance 扩展
1. 按 `Ctrl+Shift+X`
2. 搜索 "Pylance"
3. 点击 `ms-python.vscode-pylance` 右侧的小齿轮 ⚙️
4. 选择 "Disable" (禁用)
5. 等待 3 秒
6. 再次点击齿轮，选择 "Enable" (启用)
7. 点击 "Reload Required" 按钮

### 步骤 7: 清除 VSCode 缓存
1. **完全关闭 VSCode** (所有窗口)
2. 打开文件资源管理器
3. 导航到 `C:\Users\flyskyson\.vscode`
4. 删除 `cachedData` 文件夹（如果存在）
5. 删除 `extensions\.obsolete` 文件夹（如果存在）
6. 重新打开 VSCode

## 最终解决方案

如果以上都不行，尝试完整重置：

### 方案 A: 重装 Python 扩展
```
1. 完全关闭 VSCode
2. 删除以下文件夹:
   - C:\Users\flyskyson\.vscode\extensions\ms-python.python-*
   - C:\Users\flyskyson\.vscode\extensions\ms-python.vscode-pylance-*
3. 重新打开 VSCode
4. VSCode 会自动重新安装扩展
```

### 方案 B: 创建新的用户配置
```
1. 按 Ctrl+Shift+P
2. 输入 "Preferences: Open User Settings (JSON)"
3. 添加以下配置:
```

```json
{
  "editor.semanticHighlighting.enabled": true,
  "editor.tokenColorCustomizations": {
    "textMateRules": [
      {
        "scope": ["source.python"],
        "settings": {
          "foreground": "#569CD6"
        }
      }
    ]
  }
}
```

## 验证语法高亮

打开 `simple_test.py`，应该看到:
- `import` - 橙色/紫色
- `sys` - 蓝色
- `def` - 紫色
- `"字符串"` - 橙色
- `# 注释` - 绿色/灰色

## 如果仍然失败

请检查:
1. VSCode 版本是否过旧 (需要 1.80+)
2. Windows 系统语言设置
3. 是否安装了其他覆盖语法的扩展

需要更多帮助，请提供:
- VSCode 版本号
- 输出面板的 Pylance 日志
- 截图显示代码编辑器状态
