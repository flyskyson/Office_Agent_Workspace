# Word模板自动化使用指南
# 专为个体工商户登记申请书Word模板设计

## 🎯 系统简介

这是一个专门为市场监管工作人员设计的Word模板自动化系统。你可以：
1. **分析现有Word模板** - 自动识别模板中的占位符和字段
2. **生成填充代码** - 自动创建模板填充程序
3. **批量填充模板** - 自动将信息写入Word模板

## 🚀 快速开始

### 第一步：分析你的Word模板
```bash
cd market_supervision_agent
python template_analyzer.py
```

系统会：
1. 扫描当前目录的Word模板文件
2. 分析模板结构（段落、表格、占位符）
3. 识别需要的字段
4. 生成分析报告

### 第二步：生成模板填充程序
在分析完成后，选择"生成模板填充代码"，系统会自动创建一个专门针对你的模板的填充程序。

### 第三步：使用填充程序
```bash
python 个体工商户开业登记申请书（模板）_filler.py
```

按照提示填写信息，系统会自动生成填充后的Word文档。

## 📋 工具说明

### 1. template_analyzer.py - 模板分析工具
**功能**：
- 自动识别Word模板中的占位符（如 `{{个体工商户名称}}`、`[经营者姓名]` 等）
- 分析模板结构（段落、表格数量）
- 建议需要的字段
- 生成分析报告

**使用方法**：
```bash
python template_analyzer.py
```

**输出文件**：
- `模板名_analysis.json` - 详细分析报告
- `模板名_filler.py` - 自动生成的填充程序

### 2. word_application_generator.py - Word文档生成器
**功能**：
- 创建全新的Word文档（无需模板）
- 使用现有模板生成文档
- 支持交互式数据输入

**使用方法**：
```bash
python word_application_generator.py
```

### 3. 自动生成的填充程序（如：个体工商户开业登记申请书（模板）_filler.py）
**功能**：
- 专门为你的模板定制
- 交互式数据收集
- 支持JSON数据导入
- 自动保存数据和文档

## 📝 使用示例

### 示例1：分析现有模板
```
============================================================
  Word模板分析工具
  专为个体工商户登记申请书设计
============================================================

📋 找到以下模板文件：
1. 个体工商户开业登记申请书（模板）.docx (45.2 KB)

请选择要分析的模板文件编号: 1

📊 正在分析模板: 个体工商户开业登记申请书（模板）.docx
============================================================

📝 段落分析:
  段落总数: 15

📊 表格分析:
  表格总数: 3
  表格 1, 单元格(1,2): 找到占位符 [个体工商户名称]
  表格 1, 单元格(2,2): 找到占位符 [经营者姓名]
  表格 1, 单元格(3,2): 找到占位符 [身份证号码]

✅ 分析完成！
  找到占位符: 8 个
  建议字段: 12 个

📊 分析结果摘要：
  模板文件: 个体工商户开业登记申请书（模板）.docx
  文件大小: 45.2 KB
  段落数量: 15
  表格数量: 3
  找到占位符: 8 个
  具体占位符：
    • 个体工商户名称
    • 经营者姓名
    • 身份证号码
    • 经营场所
    • 经营范围
    • 资金数额
    • 联系电话
    • 申请日期

💡 建议字段 (12 个)：
    • 个体工商户名称 (必填) - 对应占位符: 个体工商户名称
    • 经营者姓名 (必填) - 对应占位符: 经营者姓名
    • 身份证号码 (必填) - 对应占位符: 身份证号码
    • 经营场所 (必填) - 个体工商户的经营地址
    • 联系电话 (必填) - 经营者的联系电话
    • 经营范围 (必填) - 个体工商户的经营范围
    • 资金数额 (必填) - 个体工商户的资金数额（单位：元）
    • 申请日期 (可选) - 申请日期（自动填充）

是否生成模板填充代码？ (y/n): y

✅ 已生成模板填充代码: 个体工商户开业登记申请书（模板）_filler.py
💡 使用方法:
  1. 确保模板文件 '个体工商户开业登记申请书（模板）.docx' 在当前目录
  2. 运行: python 个体工商户开业登记申请书（模板）_filler.py
  3. 按照提示填写信息

🎉 完成！
  1. 分析结果: 个体工商户开业登记申请书（模板）_analysis.json
  2. 填充代码: 个体工商户开业登记申请书（模板）_filler.py

💡 下一步：
  运行: python 个体工商户开业登记申请书（模板）_filler.py
  按照提示填写信息，自动生成填充后的Word文档
```

### 示例2：使用填充程序
```
============================================================
  个体工商户开业登记申请书（模板）.docx 模板填充工具
============================================================

📋 模板字段说明：
  • 个体工商户名称 (必填)
  • 经营者姓名 (必填)
  • 身份证号码 (必填)
  • 经营场所 (必填)
  • 联系电话 (必填)
  • 经营范围 (必填)
  • 资金数额 (必填)
  • 申请日期 (可选)

1. 交互式填写
2. 从JSON文件加载
3. 退出

请选择操作 (1-3): 1

📝 请填写以下信息（按Enter跳过可选字段）：
个体工商户名称: 张三小吃店
经营者姓名: 张三
身份证号码: 110101199001011234
经营场所: 北京市东城区王府井大街1号
联系电话: 13800138000
经营范围: 餐饮服务；小吃店经营
资金数额: 50000
申请日期（可选）: 2026年01月11日

✅ 模板填充成功！
📁 文件保存位置: filled_templates/张三小吃店_20260111_143022.docx
📄 数据已保存: filled_templates/张三小吃店_20260111_143022.json
```

## 🛠️ 模板格式要求

### 支持的占位符格式
系统支持以下占位符格式：

1. **双花括号**：`{{个体工商户名称}}`
2. **方括号**：`[经营者姓名]`
3. **双尖括号**：`<<身份证号码>>`
4. **双下划线**：`__经营场所__`
5. **双井号**：`##联系电话##`

### 模板设计建议
1. **使用表格**：在表格中使用占位符更容易定位和替换
2. **明确标识**：使用明显的占位符格式
3. **保持简洁**：避免复杂的格式和嵌套
4. **测试验证**：先用少量数据测试填充效果

### 最佳实践
1. **字段命名**：使用中文字段名，如 `{{个体工商户名称}}`
2. **必填字段**：在模板中标注必填字段
3. **格式保留**：确保填充后格式不变
4. **备份模板**：保留原始模板备份

## 📊 数据管理

### 生成的文件
```
filled_templates/                    # 填充后的文档目录
├── 张三小吃店_20260111_143022.docx  # 填充后的Word文档
├── 张三小吃店_20260111_143022.json  # 数据文件
├── 李四便利店_20260111_143125.docx
└── 李四便利店_20260111_143125.json

analysis/                           # 分析结果目录
├── 个体工商户开业登记申请书（模板）_analysis.json
└── 个体工商户开业登记申请书（模板）_filler.py
```

### 数据文件格式
```json
{
  "business_name": "张三小吃店",
  "operator_name": "张三",
  "id_card": "110101199001011234",
  "business_address": "北京市东城区王府井大街1号",
  "phone": "13800138000",
  "business_scope": "餐饮服务；小吃店经营",
  "registered_capital": "50000",
  "application_date": "2026年01月11日"
}
```

### 数据复用
1. **批量处理**：使用JSON文件批量生成多个文档
2. **数据导入**：将数据导入到其他系统
3. **统计分析**：基于JSON数据进行统计

## 🔄 工作流程

### 传统方式 vs 自动化方式
```
传统方式：
1. 打开Word模板
2. 手动查找每个字段位置
3. 逐个填写信息
4. 检查格式和内容
5. 保存文件
⏱️ 耗时：10-15分钟/个

自动化方式：
1. 运行填充程序
2. 输入信息（或导入JSON）
3. 系统自动填充并保存
⏱️ 耗时：1-2分钟/个
```

### 效率提升
- **单个文档**：从15分钟减少到2分钟，效率提升86%
- **批量处理**：支持JSON导入，一次处理多个文档
- **错误减少**：自动填充避免手误
- **格式统一**：确保所有文档格式一致

## 🎓 学习路径

### 第1天：基础使用
1. 运行 `python template_analyzer.py` 分析模板
2. 生成填充程序
3. 测试填充单个文档

### 第2天：批量处理
1. 创建JSON数据文件
2. 使用JSON批量生成文档
3. 管理生成的文件

### 第3天：模板优化
1. 优化Word模板格式
2. 添加更多字段
3. 测试不同占位符格式

### 第4天：集成应用
1. 将系统集成到工作流程
2. 创建批处理脚本
3. 建立文件管理规范

## 🔧 故障排除

### 问题1：找不到模板文件
**症状**：提示"未找到Word模板文件"
**解决**：
1. 确保Word模板文件在当前目录
2. 检查文件扩展名（.docx 或 .doc）
3. 检查文件权限

### 问题2：占位符识别不全
**症状**：系统没有识别所有占位符
**解决**：
1. 检查占位符格式是否符合要求
2. 在模板中使用统一的占位符格式
3. 手动在分析报告中添加字段

### 问题3：填充后格式错乱
**症状**：填充后的文档格式不正确
**解决**：
1. 简化模板格式
2. 避免使用复杂的样式
3. 在表格中使用占位符

### 问题4：程序运行错误
**症状**：程序崩溃或报错
**解决**：
1. 检查是否安装 python-docx：`pip install python-docx`
2. 检查Word文件是否损坏
3. 检查Python版本（需要Python 3.6+）

## 📈 扩展功能

### 短期计划（1-2周）
1. **批量处理界面**：图形化批量处理工具
2. **模板库管理**：管理多个模板文件
3. **数据验证**：自动验证输入数据的有效性

### 中期计划（1个月）
1. **OCR集成**：从扫描件自动提取信息
2. **数据库集成**：将数据保存到本地数据库
3. **进度跟踪**：跟踪文档处理状态

### 长期计划（3个月）
1. **智能识别**：自动识别模板字段
2. **云端同步**：支持云端模板和数据
3. **多用户协作**：支持团队协作处理

## 📞 技术支持

### 获取帮助
1. **查看本指南**：了解基本使用方法
2. **查看分析报告**：`模板名_analysis.json`
3. **检查日志文件**：程序运行时会显示详细日志

### 反馈建议
欢迎提出改进建议：
- 需要支持哪些新功能
- 模板设计遇到的问题
- 使用中的不便之处

### 版本更新
- **v1.0** (2026-01-11): 基础模板分析和填充功能
- **v1.1** (计划): 支持更多占位符格式
- **v1.2** (计划): 图形用户界面

---

**立即开始**：运行 `python template_analyzer.py` 分析你的Word模板！

**提示**：建议先备份原始模板文件，再进行测试。