# 申请表自动生成系统使用指南
# 专为市场监管工作人员设计 - 零基础友好版

## 🎯 系统特点
- **零编程经验**：完全不需要写代码
- **中文界面**：全中文操作，简单直观
- **模板驱动**：基于模板自动生成申请表
- **批量处理**：支持从JSON文件批量生成
- **数据保存**：自动保存申请表和数据文件

## 🚀 快速开始

### 第一步：运行系统
```bash
# 在项目目录中运行
cd market_supervision_agent
python application_generator.py
```

### 第二步：选择功能
系统启动后会显示菜单：
```
📋 请选择要生成的申请表类型：
1. 个体工商户设立登记申请书
2. 个体工商户变更登记申请书
3. 个体工商户注销登记申请书
4. 个体工商户年度报告表
5. 查看所有模板
6. 退出系统
```

### 第三步：填写信息
选择选项后，按照提示填写信息：
- 必填字段：必须填写
- 可选字段：可以按Enter跳过
- 中文输入：支持中文输入

### 第四步：生成文件
填写完成后，系统会自动：
1. 生成申请表文本文件
2. 保存数据为JSON文件
3. 显示文件保存位置

## 📁 文件结构

### 生成的文件
```
generated_applications/          # 生成的申请表目录
├── 设立登记申请书_张三小吃店_20260111_143022.txt
├── 设立登记申请书_张三小吃店_20260111_143022.txt.json
├── 变更登记申请书_李四便利店_20260111_143125.txt
└── 变更登记申请书_李四便利店_20260111_143125.txt.json
```

### 模板文件
```
templates/                       # 模板目录
├── 设立登记申请书.txt
├── 变更登记申请书.txt
├── 注销登记申请书.txt
└── 年报申请表.txt
```

## 📝 使用示例

### 示例1：生成个体工商户设立登记申请书
```
请选择要生成的申请表类型：1

📝 生成个体工商户设立登记申请书
请填写以下信息（按Enter跳过可选字段）：

个体工商户名称: 张三小吃店
经营者姓名: 张三
性别（男/女）: 男
身份证号码: 110101199001011234
联系电话: 13800138000
电子邮箱（可选）: zhangsan@example.com
经营场所: 北京市东城区王府井大街1号
邮政编码（可选）: 100006
经营面积（平方米，可选）: 50
经营范围: 餐饮服务；小吃店经营
主营业务（可选）: 中式快餐
行业类型（可选）: 餐饮业
资金数额（元）: 50000
资金来源（可选）: 自有资金
出资形式（可选）: 货币
经营期限（可选）: 长期

✅ 申请表生成成功！
📁 保存位置: generated_applications/设立登记申请书_张三小吃店_20260111_143022.txt
```

### 示例2：从JSON文件批量生成
1. 准备JSON数据文件 `data.json`：
```json
[
  {
    "业务类型": "设立登记",
    "个体工商户名称": "李四便利店",
    "经营者姓名": "李四",
    "身份证号码": "110101198502021234",
    "经营场所": "北京市西城区西单大街10号",
    "经营范围": "零售：日用百货、食品",
    "资金数额": "30000"
  },
  {
    "业务类型": "变更登记",
    "原个体工商户名称": "王五理发店",
    "统一社会信用代码": "91110000XXXXXXXXXX",
    "原经营者姓名": "王五",
    "变更类型": "经营者变更",
    "变更原因": "原经营者退休，转让给新经营者"
  }
]
```

2. 运行系统时输入 `json`（隐藏功能）
3. 输入JSON文件路径

## 🔧 自定义模板

### 修改现有模板
模板文件在 `templates/` 目录中，使用文本编辑器打开修改：

```txt
# 设立登记申请书.txt 示例
个体工商户设立登记申请书

申请事项：个体工商户设立登记

一、基本信息
1. 个体工商户名称：{business_name}
2. 经营者姓名：{operator_name}
...
```

**占位符格式**：`{字段名}`

### 添加新模板
1. 在 `templates/` 目录创建新文件，如 `我的模板.txt`
2. 使用占位符 `{字段名}` 标记需要填充的位置
3. 系统会自动识别新模板

## 📊 数据管理

### 生成的JSON数据文件
每个申请表都会生成对应的JSON数据文件：
```json
{
  "business_name": "张三小吃店",
  "operator_name": "张三",
  "id_card": "110101199001011234",
  "phone": "13800138000",
  "business_address": "北京市东城区王府井大街1号",
  "business_scope": "餐饮服务；小吃店经营",
  "registered_capital": "50000",
  "application_date": "2026年01月11日"
}
```

### 数据用途
1. **重复使用**：可以用相同数据生成其他文档
2. **导入系统**：可以导入到其他系统或数据库
3. **统计分析**：可以用于数据统计和分析

## 🎨 高级功能

### 批量处理
```bash
# 方法1：使用JSON文件批量生成
python application_generator.py
# 在菜单中选择时输入 "json"
# 输入JSON文件路径

# 方法2：修改代码支持命令行参数（未来版本）
```

### 模板变量
支持的模板变量：
- `{business_name}` - 个体工商户名称
- `{operator_name}` - 经营者姓名
- `{id_card}` - 身份证号码
- `{phone}` - 联系电话
- `{business_address}` - 经营场所
- `{business_scope}` - 经营范围
- `{registered_capital}` - 资金数额
- `{application_date}` - 申请日期（自动生成）
- 其他自定义变量

## 🔄 与其他系统集成

### 与浏览器自动化集成
生成的JSON数据可以直接用于浏览器自动化：
```python
# 示例：使用生成的数据自动填写表单
data = {
    "business_name": "张三小吃店",
    "operator_name": "张三",
    # ... 其他字段
}

# 自动填写政务网站表单
automation.fill_form(data)
```

### 与本地数据库集成
```python
# 示例：保存到本地数据库
import sqlite3

conn = sqlite3.connect('business_database.db')
cursor = conn.cursor()

# 创建表
cursor.execute('''
CREATE TABLE IF NOT EXISTS applications (
    id INTEGER PRIMARY KEY,
    business_name TEXT,
    operator_name TEXT,
    application_date TEXT,
    application_type TEXT
)
''')

# 插入数据
cursor.execute('''
INSERT INTO applications (business_name, operator_name, application_date, application_type)
VALUES (?, ?, ?, ?)
''', (data['business_name'], data['operator_name'], data['application_date'], '设立登记'))

conn.commit()
conn.close()
```

## 📈 扩展计划

### 短期计划（1-2周）
1. 支持Word文档格式输出
2. 支持PDF格式输出
3. 添加更多业务模板
4. 图形用户界面（GUI）

### 中期计划（1个月）
1. 与扫描件OCR集成
2. 与政务网站自动化集成
3. 本地数据库管理
4. 批量处理优化

### 长期计划（3个月）
1. 智能表单识别
2. 数据验证和检查
3. 多用户协作
4. 云端同步

## 🆘 常见问题

### Q1: 运行时报错 "No module named..."
**A**: 需要安装Python依赖：
```bash
pip install -r requirements.txt
```

### Q2: 生成的文件在哪里？
**A**: 在 `generated_applications/` 目录中

### Q3: 如何修改模板？
**A**: 编辑 `templates/` 目录中的 `.txt` 文件

### Q4: 支持批量生成吗？
**A**: 支持，使用JSON文件批量生成（输入 `json` 进入批量模式）

### Q5: 生成的文档格式太简单？
**A**: 当前版本生成文本格式，后续版本将支持Word、PDF等格式

## 📞 技术支持

### 获取帮助
1. 查看本指南
2. 运行 `python application_generator.py --help`（未来版本）
3. 联系技术支持

### 反馈建议
欢迎提出改进建议：
- 需要哪些新模板
- 希望支持哪些功能
- 使用中遇到的问题

### 版本更新
- **v1.0** (2026-01-11): 基础文本生成功能
- **v1.1** (计划): 支持Word文档输出
- **v1.2** (计划): 图形用户界面

---

**立即开始**：运行 `python application_generator.py` 体验自动化生成申请表的便利！

**提示**：所有生成的文件都保存在 `generated_applications/` 目录，建议定期备份重要数据。