<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF æ–‡æœ¬æå–å™¨ - æµç¨‹å›¾é¢„è§ˆ</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 40px;
            padding: 10px;
            background-color: #ecf0f1;
            border-left: 5px solid #3498db;
        }
        .mermaid {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
            text-align: center;
        }
        .info-box {
            background-color: #e8f4f8;
            border: 1px solid #b8d4e3;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
        }
        .toc {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .toc h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        .toc a {
            color: #3498db;
            text-decoration: none;
        }
        .toc a:hover {
            color: #2980b9;
            text-decoration: underline;
        }
        #loading {
            text-align: center;
            padding: 20px;
            font-size: 18px;
            color: #3498db;
        }
        .error-message {
            background-color: #ffebee;
            border: 1px solid #ef5350;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            color: #c62828;
        }
    </style>
</head>
<body>
    <h1>ğŸ“Š PDF æ–‡æœ¬æå–å™¨ - ç¨‹åºæµç¨‹å›¾</h1>

    <div class="info-box">
        <strong>ğŸ’¡ æç¤ºï¼š</strong>å¦‚æœæµç¨‹å›¾æ²¡æœ‰æ˜¾ç¤ºï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆéœ€è¦åŠ è½½ Mermaid åº“ï¼‰ã€‚æˆ–è€…ä½¿ç”¨ VSCode çš„ Markdown Preview Mermaid Support æ’ä»¶æŸ¥çœ‹ <a href="æµç¨‹å›¾.md">æµç¨‹å›¾.md</a> æ–‡ä»¶ã€‚
    </div>

    <div id="loading">æ­£åœ¨åŠ è½½æµç¨‹å›¾åº“ï¼Œè¯·ç¨å€™...</div>

    <div class="toc">
        <h3>ğŸ“‘ ç›®å½•</h3>
        <ul>
            <li><a href="#main-flow">1. ä¸»æµç¨‹å›¾ - ç¨‹åºå®Œæ•´æ‰§è¡Œæµç¨‹</a></li>
            <li><a href="#extract-flow">2. æ ¸å¿ƒå‡½æ•°æµç¨‹ - extract_text_from_pdf()</a></li>
            <li><a href="#ocr-flow">3. OCRå‡½æ•°æµç¨‹ - extract_text_with_ocr()</a></li>
            <li><a href="#markdown-flow">4. Markdownä¿å­˜æµç¨‹ - save_to_markdown()</a></li>
            <li><a href="#json-flow">5. JSONä¿å­˜æµç¨‹ - save_to_json()</a></li>
            <li><a href="#module-flow">6. ç¨‹åºæ¨¡å—å…³ç³»å›¾</a></li>
            <li><a href="#data-flow">7. æ•°æ®æµå‘å›¾</a></li>
            <li><a href="#decision-tree">8. PDFå¤„ç†ç­–ç•¥å†³ç­–æ ‘</a></li>
            <li><a href="#error-flow">9. é”™è¯¯å¤„ç†æµç¨‹</a></li>
        </ul>
    </div>

    <h2 id="main-flow">1. ä¸»æµç¨‹å›¾ - ç¨‹åºå®Œæ•´æ‰§è¡Œæµç¨‹</h2>
    <div class="mermaid">
flowchart TD
    Start([ç¨‹åºå¯åŠ¨]) --> Init[å¯¼å…¥åº“å’Œæ£€æŸ¥OCRåŠŸèƒ½]
    Init --> ParseArgs[è§£æå‘½ä»¤è¡Œå‚æ•°]
    ParseArgs --> CheckFolder{æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨?}
    CheckFolder -->|å¦| ShowError[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯] --> End1([ç¨‹åºç»“æŸ])
    CheckFolder -->|æ˜¯| ScanFolder[æ‰«æPDFæ–‡ä»¶]
    ScanFolder --> CheckFiles{æ‰¾åˆ°PDF?}
    CheckFiles -->|å¦| ShowWarning[æ˜¾ç¤ºæœªæ‰¾åˆ°PDF] --> End2([ç¨‹åºç»“æŸ])
    CheckFiles -->|æ˜¯| ShowInfo[æ˜¾ç¤ºå¤„ç†ä¿¡æ¯]

    ShowInfo --> ProcessLoop[éå†æ¯ä¸ªPDFæ–‡ä»¶]
    ProcessLoop --> CheckMode{æ˜¯å¦å¼ºåˆ¶OCR?}

    CheckMode -->|æ˜¯| CallOCR[è°ƒç”¨OCRæå–]
    CheckMode -->|å¦| TryExtract[å°è¯•æ–‡æœ¬æå–]

    TryExtract --> ExtractSuccess{æå–æˆåŠŸ?}
    ExtractSuccess -->|æ˜¯| CheckThreshold{å­—ç¬¦æ•° &lt; é˜ˆå€¼?}
    ExtractSuccess -->|å¦| FallbackOCR[OCRé™çº§å¤„ç†]

    CheckThreshold -->|æ˜¯| TryOCR[å°è¯•OCR]
    CheckThreshold -->|å¦| SaveResult1[ä¿å­˜æ–‡æœ¬æå–ç»“æœ]

    TryOCR --> OCRSuccess{OCRæˆåŠŸ?}
    OCRSuccess -->|æ˜¯| CompareResult{OCRç»“æœæ›´å¥½?}
    OCRSuccess -->|å¦| SaveResult1

    CompareResult -->|æ˜¯| SaveResult2[ä¿å­˜OCRç»“æœ]
    CompareResult -->|å¦| SaveResult1

    CallOCR --> OCRCheck{OCRå¯ç”¨?}
    OCRCheck -->|å¦| ShowOCRError[æ˜¾ç¤ºOCRä¸å¯ç”¨] --> SaveFail[æ ‡è®°å¤±è´¥]
    OCRCheck -->|æ˜¯| OCRProcess[æ‰§è¡ŒOCRå¤„ç†]

    FallbackOCR --> FallbackSuccess{é™çº§æˆåŠŸ?}
    FallbackSuccess -->|æ˜¯| SaveResult3[ä¿å­˜é™çº§ç»“æœ]
    FallbackSuccess -->|å¦| SaveFail

    OCRProcess --> SaveResult2
    SaveResult1 --> NextFile{è¿˜æœ‰æ–‡ä»¶?}
    SaveResult2 --> NextFile
    SaveResult3 --> NextFile
    SaveFail --> NextFile

    NextFile -->|æ˜¯| ProcessLoop
    NextFile -->|å¦| SaveFile[ä¿å­˜åˆ°æ–‡ä»¶]

    SaveFile --> ShowStats[æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯]
    ShowStats --> End3([ç¨‹åºæˆåŠŸç»“æŸ])
    </div>

    <h2 id="extract-flow">2. æ ¸å¿ƒå‡½æ•°æµç¨‹ - extract_text_from_pdf()</h2>
    <div class="mermaid">
flowchart TD
    Start([å¼€å§‹: extract_text_from_pdf]) --> CheckForce{force_ocr = True?}

    CheckForce -->|æ˜¯| OCRAvailable{OCRå¯ç”¨?}
    OCRAvailable -->|å¦| ReturnError1[è¿”å›: OCRä¸å¯ç”¨]
    OCRAvailable -->|æ˜¯| CallOCRFunc[è°ƒç”¨ extract_text_with_ocr]
    CallOCRFunc --> ReturnOCR[è¿”å›OCRç»“æœ]

    CheckForce -->|å¦| OpenPDF[ä½¿ç”¨pdfplumberæ‰“å¼€PDF]
    OpenPDF --> InitLoop[åˆå§‹åŒ– all_text å’Œ total_chars]

    InitLoop --> PageLoop{éå†æ¯ä¸€é¡µ}

    PageLoop --> ExtractPage[page.extract_text]
    ExtractPage --> HasText{æå–åˆ°æ–‡æœ¬?}

    HasText -->|æ˜¯| AddText[æ·»åŠ åˆ°all_textå¹¶ç»Ÿè®¡å­—ç¬¦]
    HasText -->|å¦| AddEmpty[æ ‡è®°ç©ºç™½é¡µ]

    AddText --> PageLoop
    AddEmpty --> PageLoop

    PageLoop -->|ç»“æŸ| JoinText[åˆå¹¶æ–‡æœ¬]

    JoinText --> CalcStats[è®¡ç®—ç©ºç™½é¡µæ•°é‡å’Œæ¯”ä¾‹]
    CalcStats --> NeedOCR{éœ€è¦OCR?}

    NeedOCR -->|æ˜¯| OCRCheck2{OCRå¯ç”¨?}
    OCRCheck2 -->|å¦| CheckResult1[æ£€æŸ¥æ˜¯å¦æœ‰æ–‡æœ¬]
    OCRCheck2 -->|æ˜¯| RunOCR[æ‰§è¡ŒOCRæå–]

    NeedOCR -->|å¦| CheckResult1

    RunOCR --> OCRBetter{OCRç»“æœæ›´å¥½?}
    OCRBetter -->|æ˜¯| ReturnOCR2[è¿”å›OCRç»“æœ]
    OCRBetter -->|å¦| KeepOriginal[ä¿ç•™åŸç»“æœ]

    KeepOriginal --> CheckResult1{total_chars &gt; 0?}
    CheckResult1 -->|æ˜¯| ReturnSuccess[è¿”å›: æˆåŠŸ + å­—ç¬¦æ•°]
    CheckResult1 -->|å¦| ReturnFail[è¿”å›: æ— æœ‰æ•ˆæ–‡æœ¬]

    ReturnOCR2 --> End([ç»“æŸ])
    ReturnSuccess --> End
    ReturnFail --> End
    ReturnOCR --> End
    ReturnError1 --> End
    </div>

    <h2 id="ocr-flow">3. OCRå‡½æ•°æµç¨‹ - extract_text_with_ocr()</h2>
    <div class="mermaid">
flowchart TD
    Start([å¼€å§‹: extract_text_with_ocr]) --> CheckAvailable{OCR_AVAILABLE?}
    CheckAvailable -->|å¦| ReturnError[è¿”å›: OCRåŠŸèƒ½æœªå®‰è£…]

    CheckAvailable -->|æ˜¯| CheckOS{æ˜¯Windowsç³»ç»Ÿ?}

    CheckOS -->|æ˜¯| SetPath1[è®¾ç½®Popplerè·¯å¾„]
    SetPath1 --> SetPath2[è®¾ç½®Tesseractè·¯å¾„]
    SetPath2 --> SetEnv[è®¾ç½®è¯­è¨€åŒ…ç¯å¢ƒå˜é‡]

    CheckOS -->|å¦| SkipPath[è·³è¿‡è·¯å¾„é…ç½®]

    SetEnv --> ConvertPDF
    SkipPath --> ConvertPDF[convert_from_path: PDFè½¬å›¾ç‰‡]

    ConvertPDF --> CheckImages{è½¬æ¢æˆåŠŸ?}
    CheckImages -->|å¦| ReturnError2[è¿”å›: PDFè½¬æ¢å¤±è´¥]

    CheckImages -->|æ˜¯| InitOCR[åˆå§‹åŒ– all_text åˆ—è¡¨]
    InitOCR --> ShowProgress[æ˜¾ç¤ºè¿›åº¦ä¿¡æ¯]

    ShowProgress --> PageLoop{éå†æ¯ä¸€é¡µå›¾ç‰‡}

    PageLoop --> DoOCR[pytesseractè¯†åˆ«]
    DoOCR --> OCRSuccess{è¯†åˆ«æˆåŠŸ?}

    OCRSuccess -->|æ˜¯| CheckEmpty{è¯†åˆ«åˆ°æ–‡å­—?}
    CheckEmpty -->|æ˜¯| AddOCRText[æ·»åŠ è¯†åˆ«æ–‡æœ¬]
    CheckEmpty -->|å¦| AddNoText[æ ‡è®°æœªè¯†åˆ«åˆ°æ–‡å­—]

    OCRSuccess -->|å¦| AddOCRError[è®°å½•è¯†åˆ«é”™è¯¯]

    AddOCRText --> PageLoop
    AddNoText --> PageLoop
    AddOCRError --> PageLoop

    PageLoop -->|ç»“æŸ| CheckAnyText{æœ‰æ–‡æœ¬?}

    CheckAnyText -->|å¦| ReturnError3[è¿”å›: æœªè¯†åˆ«åˆ°æ–‡å­—]

    CheckAnyText -->|æ˜¯| JoinResult[åˆå¹¶ç»“æœ]
    JoinResult --> ReturnSuccess[è¿”å›: æˆåŠŸ + OCRæ–‡æœ¬]

    ReturnSuccess --> End([ç»“æŸ])
    ReturnError --> End
    ReturnError2 --> End
    ReturnError3 --> End
    </div>

    <h2 id="markdown-flow">4. Markdownä¿å­˜æµç¨‹ - save_to_markdown()</h2>
    <div class="mermaid">
flowchart TD
    Start([å¼€å§‹: save_to_markdown]) --> OpenFile[æ‰“å¼€/åˆ›å»ºMarkdownæ–‡ä»¶]
    OpenFile --> WriteTitle[å†™å…¥æ–‡ä»¶æ ‡é¢˜å’Œæ—¶é—´]
    WriteTitle --> CalcStats[è®¡ç®—ç»Ÿè®¡ä¿¡æ¯]

    CalcStats --> WriteStats[å†™å…¥: æ€»æ•°/æˆåŠŸ/OCRæ•°/å¤±è´¥]
    WriteStats --> WriteSeparator[å†™å…¥åˆ†éš”çº¿]

    WriteSeparator --> FileLoop{éå†æ¯ä¸ªæ–‡ä»¶ç»“æœ}

    FileLoop --> WriteFileName[å†™å…¥æ–‡ä»¶åæ ‡é¢˜]
    WriteFileName --> WriteMethod[å†™å…¥æå–æ–¹å¼]

    WriteMethod --> CheckSuccess{æå–æˆåŠŸ?}
    CheckSuccess -->|æ˜¯| WriteContent[å†™å…¥æ–‡æœ¬å†…å®¹]
    CheckSuccess -->|å¦| WriteError[å†™å…¥é”™è¯¯ä¿¡æ¯]

    WriteContent --> WriteSep2[å†™å…¥åˆ†éš”çº¿]
    WriteError --> WriteSep2

    WriteSep2 --> FileLoop

    FileLoop -->|ç»“æŸ| CloseFile[å…³é—­æ–‡ä»¶]
    CloseFile --> End([ç»“æŸ])
    </div>

    <h2 id="json-flow">5. JSONä¿å­˜æµç¨‹ - save_to_json()</h2>
    <div class="mermaid">
flowchart TD
    Start([å¼€å§‹: save_to_json]) --> CalcStats[è®¡ç®—ç»Ÿè®¡ä¿¡æ¯]
    CalcStats --> BuildDict[æ„å»ºæ•°æ®å­—å…¸]

    BuildDict --> AddMeta[æ·»åŠ : æå–æ—¶é—´]
    AddMeta --> AddStats[æ·»åŠ : ç»Ÿè®¡ä¿¡æ¯]
    AddStats --> InitList[åˆå§‹åŒ–æ–‡ä»¶åˆ—è¡¨]

    InitList --> FileLoop{éå†æ¯ä¸ªæ–‡ä»¶ç»“æœ}

    FileLoop --> CreateFileDict[åˆ›å»ºæ–‡ä»¶æ•°æ®å­—å…¸]
    CreateFileDict --> AddBasic[æ·»åŠ : æ–‡ä»¶å/æ–¹å¼/çŠ¶æ€]

    AddBasic --> CheckSuccess{æå–æˆåŠŸ?}
    CheckSuccess -->|æ˜¯| AddContent[æ·»åŠ : å†…å®¹/å­—ç¬¦æ•°/æ˜¯å¦OCR]
    CheckSuccess -->|å¦| AddErrorMsg[æ·»åŠ : é”™è¯¯ä¿¡æ¯]

    AddContent --> AppendList[æ·»åŠ åˆ°æ–‡ä»¶åˆ—è¡¨]
    AddErrorMsg --> AppendList

    AppendList --> FileLoop

    FileLoop -->|ç»“æŸ| WriteFile[json.dumpå†™å…¥æ–‡ä»¶]
    WriteFile --> End([ç»“æŸ])
    </div>

    <h2 id="module-flow">6. ç¨‹åºæ¨¡å—å…³ç³»å›¾</h2>
    <div class="mermaid">
graph TB
    subgraph å…¥å£å±‚
        Main[mainå‡½æ•°]
    end

    subgraph æ§åˆ¶å±‚
        Process[process_pdfsä¸»å¤„ç†å‡½æ•°]
        Parse[parse_argumentså‚æ•°è§£æ]
    end

    subgraph ä¸šåŠ¡é€»è¾‘å±‚
        GetPDF[get_pdf_filesè·å–PDFåˆ—è¡¨]
        Extract[extract_text_from_pdfæ™ºèƒ½æå–]
        OCR[extract_text_with_ocr OCRæå–]
    end

    subgraph æ•°æ®æŒä¹…å±‚
        SaveMD[save_to_markdown]
        SaveJSON[save_to_json]
    end

    Main --> Parse
    Main --> Process
    Process --> GetPDF
    Process --> Extract
    Extract --> OCR
    Process --> SaveMD
    Process --> SaveJSON

    style Main fill:#e1f5ff
    style Process fill:#fff4e1
    style Extract fill:#ffe1f5
    style OCR fill:#f5ffe1
    </div>

    <h2 id="data-flow">7. æ•°æ®æµå‘å›¾</h2>
    <div class="mermaid">
flowchart LR
    Input[è¾“å…¥: PDFæ–‡ä»¶å¤¹] --> Scan[æ‰«æPDFæ–‡ä»¶]
    Scan --> Files[PDFæ–‡ä»¶åˆ—è¡¨]

    Files --> Extract{æ™ºèƒ½æå–}
    Extract -->|æ–‡æœ¬å‹PDF| Direct[ç›´æ¥æå–æ–‡æœ¬]
    Extract -->|æ‰«æä»¶PDF| OCR[OCRè¯†åˆ«]

    Direct --> Results[æå–ç»“æœåˆ—è¡¨]
    OCR --> Results

    Results --> Format{è¾“å‡ºæ ¼å¼?}
    Format -->|Markdown| MD[.mdæ–‡ä»¶]
    Format -->|JSON| JSON[.jsonæ–‡ä»¶]

    MD --> Output[è¾“å‡ºæ–‡ä»¶]
    JSON --> Output

    Output --> Console[æ§åˆ¶å°ç»Ÿè®¡ä¿¡æ¯]

    style Input fill:#e3f2fd
    style Output fill:#c8e6c9
    style Console fill:#fff9c4
    </div>

    <h2 id="decision-tree">8. PDFå¤„ç†ç­–ç•¥å†³ç­–æ ‘</h2>
    <div class="mermaid">
flowchart TD
    Start([PDFæ–‡ä»¶è¾“å…¥]) --> Q1{å¼ºåˆ¶OCRæ¨¡å¼?}

    Q1 -->|æ˜¯| OCR1[ç›´æ¥ä½¿ç”¨OCR]
    Q1 -->|å¦| Q2{å°è¯•æ–‡æœ¬æå–}

    Q2 -->|æˆåŠŸ| Q3{æå–çš„å­—ç¬¦æ•° &lt; 50?}
    Q2 -->|å¤±è´¥| OCR2[é™çº§åˆ°OCR]

    Q3 -->|æ˜¯| Q4{è¶…è¿‡50%é¡µé¢ç©ºç™½?}
    Q3 -->|å¦| Direct1[ä½¿ç”¨æ–‡æœ¬æå–ç»“æœ]

    Q4 -->|æ˜¯| OCR3[å°è¯•OCRå¢å¼º]
    Q4 -->|å¦| Direct1

    OCR3 --> Q5{OCRç»“æœæ›´å¥½?}
    Q5 -->|æ˜¯| Direct2[ä½¿ç”¨OCRç»“æœ]
    Q5 -->|å¦| Direct1

    OCR1 --> End([è¾“å‡ºç»“æœ])
    OCR2 --> End
    Direct1 --> End
    Direct2 --> End

    style OCR1 fill:#ffcccb
    style OCR2 fill:#ffcccb
    style OCR3 fill:#ffcccb
    style Direct1 fill:#90ee90
    style Direct2 fill:#90ee90
    </div>

    <h2 id="error-flow">9. é”™è¯¯å¤„ç†æµç¨‹</h2>
    <div class="mermaid">
flowchart TD
    Start([æ“ä½œæ‰§è¡Œ]) --> Try{å°è¯•æ‰§è¡Œ}

    Try -->|æˆåŠŸ| Success[è¿”å›æˆåŠŸç»“æœ]
    Try -->|å¤±è´¥| CatchError[æ•è·å¼‚å¸¸]

    CatchError --> Analyze{åˆ†æé”™è¯¯ç±»å‹}

    Analyze -->|æ–‡ä»¶ä¸å­˜åœ¨| FileNotFound[è¿”å›: FileNotFoundError]
    Analyze -->|ä¸æ˜¯æ–‡ä»¶å¤¹| NotDir[è¿”å›: NotADirectoryError]
    Analyze -->|PDFåŠ å¯†| Encrypted[è¿”å›: PDFå·²åŠ å¯†]
    Analyze -->|PDFæŸå| Damaged[è¿”å›: PDFæŸå]
    Analyze -->|OCRæœªå®‰è£…| NoOCR[è¿”å›: OCRä¸å¯ç”¨]
    Analyze -->|å…¶ä»–é”™è¯¯| Other[è¿”å›: é€šç”¨é”™è¯¯ä¿¡æ¯]

    FileNotFound --> Log[è®°å½•é”™è¯¯æ—¥å¿—]
    NotDir --> Log
    Encrypted --> Log
    Damaged --> Log
    NoOCR --> Log
    Other --> Log

    Log --> Continue{ç»§ç»­å¤„ç†?}
    Continue -->|æ˜¯| NextFile[å¤„ç†ä¸‹ä¸€ä¸ªæ–‡ä»¶]
    Continue -->|å¦| Exit[ç»ˆæ­¢ç¨‹åº]

    Success --> End([ç»“æŸ])
    NextFile --> End
    Exit --> End
    </div>

    <div class="info-box" style="margin-top: 50px;">
        <h3>ğŸ“š å…³é”®æ•°æ®ç»“æ„è¯´æ˜</h3>
        <h4>æå–ç»“æœå…ƒç»„ï¼š</h4>
        <pre><code>(filename: str, content: str, success: bool, method: str)</code></pre>

        <h4>OCR è¿”å›å…ƒç»„ï¼š</h4>
        <pre><code>(text: str, success: bool, message: str)</code></pre>

        <h4>ç¨‹åºæ ¸å¿ƒç‰¹ç‚¹ï¼š</h4>
        <ul>
            <li>âœ… <strong>æ™ºèƒ½é™çº§</strong>ï¼šæ–‡æœ¬æå– â†’ è‡ªåŠ¨OCR â†’ å¼ºåˆ¶OCR</li>
            <li>âœ… <strong>å®¹é”™æœºåˆ¶</strong>ï¼šå•ä¸ªæ–‡ä»¶å¤±è´¥ä¸å½±å“å…¶ä»–æ–‡ä»¶</li>
            <li>âœ… <strong>çµæ´»è¾“å‡º</strong>ï¼šæ”¯æŒ Markdown å’Œ JSON ä¸¤ç§æ ¼å¼</li>
            <li>âœ… <strong>è¯¦ç»†ç»Ÿè®¡</strong>ï¼šè®°å½•æå–æ–¹å¼ã€å­—ç¬¦æ•°ã€æˆåŠŸç‡ç­‰ä¿¡æ¯</li>
            <li>âœ… <strong>ç¼–ç å¤„ç†</strong>ï¼šWindows æ§åˆ¶å° UTF-8 ç¼–ç ä¿®å¤</li>
        </ul>
    </div>

    <!-- ä½¿ç”¨å¤šä¸ª CDN æºï¼Œç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªå¯ä»¥å·¥ä½œ -->
    <script>
        // å°è¯•åŠ è½½ Mermaid
        function loadMermaid() {
            var cdns = [
                'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js',
                'https://unpkg.com/mermaid@10/dist/mermaid.min.js',
                'https://cdn.bootcdn.net/ajax/libs/mermaid/10.6.1/mermaid.min.js'
            ];

            var loadingIndex = 0;

            function tryLoadCDN(index) {
                if (index >= cdns.length) {
                    document.getElementById('loading').innerHTML =
                        '<div class="error-message">âŒ æ— æ³•åŠ è½½ Mermaid åº“ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œæˆ–ä½¿ç”¨ VSCode æŸ¥çœ‹æµç¨‹å›¾.md æ–‡ä»¶ã€‚</div>';
                    return;
                }

                var script = document.createElement('script');
                script.src = cdns[index];
                script.onload = function() {
                    document.getElementById('loading').style.display = 'none';
                    mermaid.initialize({
                        startOnLoad: true,
                        theme: 'default',
                        flowchart: {
                            useMaxWidth: true,
                            htmlLabels: true,
                            curve: 'basis'
                        },
                        securityLevel: 'loose'
                    });
                };
                script.onerror = function() {
                    console.log('CDN ' + cdns[index] + ' failed, trying next...');
                    tryLoadCDN(index + 1);
                };
                document.head.appendChild(script);
            }

            tryLoadCDN(0);
        }

        // é¡µé¢åŠ è½½å®ŒæˆååŠ è½½ Mermaid
        window.addEventListener('load', loadMermaid);
    </script>
</body>
</html>
