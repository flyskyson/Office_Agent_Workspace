# 李奕凤版申请书填充工具 - 使用指南

## 工具简介

这是一个专门用于填充"李奕凤版个体工商户开业登记申请书"的智能工具。

### 核心功能
- 自动识别并删除模板中的红色字体（示例数据）
- 智能识别字段名并填充实际数据
- 完美保持模板格式和布局
- 自动用WPS打开生成的文档
- 支持单条数据处理和批量处理

### 技术特点
- 智能字段识别：支持从左侧单元格、上方单元格识别字段名
- 格式完美保持：自动继承模板的字体格式
- 数据保存：自动生成JSON数据文件备查
- 批量处理：支持一次处理多条申请数据

---

## 快速开始

### 1. 测试运行（推荐首次使用）

```bash
python 李奕凤版申请书填充工具.py --test
```

这将使用预设的测试数据生成一份申请书，方便您快速了解工具效果。

### 2. 准备数据文件

创建一个JSON文件（例如 `my_data.json`），内容如下：

```json
{
  "business_name": "张三便利店",
  "operator_name": "张三",
  "phone": "13800138000",
  "email": "zhangsan@example.com",
  "business_address": "北京市朝阳区建国路123号",
  "postal_code": "100000",
  "employee_count": "3",
  "registered_capital": "50000",
  "id_card": "110101199001011234",
  "gender": "男",
  "nation": "汉族",
  "political_status": "群众",
  "education": "高中",
  "business_scope": "日用百货销售",
  "operation_period": "长期"
}
```

### 3. 生成申请书

```bash
python 李奕凤版申请书填充工具.py --data my_data.json
```

工具会自动：
1. 读取模板文件
2. 删除红色字体示例数据
3. 填充您的实际数据
4. 保存生成的文档
5. 用WPS打开文档供查看

---

## 命令行参数说明

### 基本参数

| 参数 | 说明 | 示例 |
|------|------|------|
| `--test` | 使用测试数据 | `--test` |
| `--data <文件>` | 从JSON文件加载单条数据 | `--data data.json` |
| `--batch <文件>` | 批量处理JSON文件 | `--batch list.json` |
| `--template <文件>` | 指定模板文件 | `--template mytemplate.docx` |
| `--output <目录>` | 指定输出目录 | `--output myoutput` |
| `--no-open` | 不自动打开文档 | `--no-open` |

### 使用示例

#### 示例1：使用测试数据
```bash
python 李奕凤版申请书填充工具.py --test
```

#### 示例2：从文件加载数据
```bash
python 李奕凤版申请书填充工具.py --data applicant.json
```

#### 示例3：批量处理
```bash
python 李奕凤版申请书填充工具.py --batch applicants.json
```

#### 示例4：指定自定义模板
```bash
python 李奕凤版申请书填充工具.py --data data.json --template mytemplate.docx
```

#### 示例5：批量处理不自动打开
```bash
python 李奕凤版申请书填充工具.py --batch list.json --no-open
```

---

## 数据字段说明

### 必填字段

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `business_name` | 个体工商户名称 | "张三便利店" |
| `operator_name` | 经营者姓名 | "张三" |
| `id_card` | 身份证号码 | "110101199001011234" |
| `business_address` | 经营场所地址 | "北京市朝阳区建国路123号" |
| `business_scope` | 经营范围 | "日用百货销售" |

### 可选字段

| 字段名 | 说明 | 示例 |
|--------|------|------|
| `phone` | 联系电话 | "13800138000" |
| `email` | 电子邮箱 | "zhangsan@example.com" |
| `postal_code` | 邮政编码 | "100000" |
| `employee_count` | 从业人数 | "3" |
| `registered_capital` | 注册资金 | "50000" |
| `gender` | 性别 | "男" |
| `nation` | 民族 | "汉族" |
| `political_status` | 政治面貌 | "群众" |
| `education` | 文化程度 | "高中" |
| `operation_period` | 经营期限 | "长期" |

---

## 批量处理

### 准备批量数据文件

创建一个包含多条数据的JSON文件（例如 `applicants.json`）：

```json
[
  {
    "business_name": "张三便利店",
    "operator_name": "张三",
    "phone": "13800138000",
    "id_card": "110101199001011234",
    "business_address": "北京市朝阳区建国路123号",
    "business_scope": "日用百货销售"
  },
  {
    "business_name": "李四超市",
    "operator_name": "李四",
    "phone": "13900139000",
    "id_card": "110101199002022345",
    "business_address": "北京市海淀区中关村路456号",
    "business_scope": "食品零售；烟酒销售"
  }
]
```

### 执行批量处理

```bash
python 李奕凤版申请书填充工具.py --batch applicants.json
```

工具会：
1. 读取所有申请数据
2. 逐一生成申请书
3. 保存到output目录
4. 打开最后一个生成的文档

---

## 输出文件说明

### 生成的文件

每次运行会生成两个文件：

1. **申请书文档**：`{个体工商户名称}_开业登记_{时间戳}.docx`
   - 示例：`张三便利店_开业登记_20240112_120000.docx`

2. **数据文件**：`{个体工商户名称}_开业登记_{时间戳}.json`
   - 示例：`张三便利店_开业登记_20240112_120000.json`
   - 保存填入的数据，方便备查

### 文件位置

默认保存在 `output` 目录下。可以使用 `--output` 参数指定其他目录。

---

## 常见问题

### Q1: 模板文件找不到？

**错误信息**：`[错误] 模板文件不存在`

**解决方法**：
1. 确认模板文件 `（李奕凤）个体工商户开业登记申请书（模板）.docx` 在当前目录
2. 或使用 `--template` 参数指定模板文件路径

### Q2: 某些字段没有填充？

**原因**：模板中该字段的红色字体位置可能与字段名不在同一行或相邻位置。

**解决方法**：
1. 目前工具支持左侧单元格的字段名识别
2. 对于未填充的字段，可以手动在WPS中补充
3. 后续版本会增强字段识别能力

### Q3: 如何修改输出文件名？

目前文件名自动生成：`{个体工商户名称}_开业登记_{时间戳}.docx`

如需自定义，可以在生成后手动重命名。

### Q4: WPS没有自动打开？

**可能原因**：
1. 系统默认打开方式不是WPS
2. 使用了 `--no-open` 参数

**解决方法**：
1. 手动在WPS中打开生成的文档
2. 或设置系统默认用WPS打开.docx文件

---

## 工作原理

### 智能识别流程

```
1. 读取Word模板
   ↓
2. 遍历所有表格和单元格
   ↓
3. 发现红色字体 → 标记为需要填充的位置
   ↓
4. 查找左侧单元格的文字作为字段名
   ↓
5. 匹配数据中的对应字段
   ↓
6. 删除红色字体，填充实际数据
   ↓
7. 保存文档并打开
```

### 字段识别规则

工具使用以下规则识别字段：

| 模板中的字段名 | 数据字段 |
|----------------|----------|
| 个体工商户名称、名称、字号 | business_name |
| 经营者姓名、经营者 | operator_name |
| 联系电话、电话 | phone |
| 电子邮箱、邮箱 | email |
| 经营场所、住所、地址 | business_address |
| 身份证号码、身份证 | id_card |
| 性别 | gender |
| 民族 | nation |
| 政治面貌、政治 | political_status |
| 文化程度、学历 | education |
| 邮政编码、邮编 | postal_code |
| 从业人数、人数 | employee_count |
| 注册资金、资金 | registered_capital |
| 经营范围 | business_scope |
| 经营期限、期限 | operation_period |

---

## 技术支持

如有问题或建议，请联系开发团队。

---

## 更新日志

### v2（当前版本）
- 支持命令行参数
- 支持批量处理
- 增强字段识别能力
- 优化输出格式

### v1
- 初始版本
- 支持基本填充功能
- 支持测试数据

---

## 许可证

本工具为内部使用工具，请勿外传。
