# Jinja2 æ¨¡æ¿ç‰ˆä½¿ç”¨æŒ‡å—

> **ç‰ˆæœ¬**: v3.0
> **åŸºäº**: python-docx-template (docxtpl)
> **ä½œè€…**: Claude Code + zread ååŠ©å¼€å‘
> **æ›´æ–°æ—¥æœŸ**: 2026-01-12

---

## ğŸ“‹ ç›®å½•

1. [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
2. [æ¨¡æ¿åˆ¶ä½œ](#æ¨¡æ¿åˆ¶ä½œ)
3. [æ•°æ®æ ¼å¼](#æ•°æ®æ ¼å¼)
4. [é«˜çº§åŠŸèƒ½](#é«˜çº§åŠŸèƒ½)
5. [å‘½ä»¤è¡Œä½¿ç”¨](#å‘½ä»¤è¡Œä½¿ç”¨)
6. [ä»æ—§ç‰ˆè¿ç§»](#ä»æ—§ç‰ˆè¿ç§»)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install docxtpl
```

### 2. åˆ›å»ºæ¨¡æ¿

åœ¨ Word æ–‡æ¡£ä¸­è¾“å…¥å˜é‡å ä½ç¬¦ï¼š

```
ä¸ªä½“å·¥å•†æˆ·åç§°ï¼š{{business_name}}
ç»è¥è€…å§“åï¼š{{operator_name}}
è”ç³»ç”µè¯ï¼š{{phone}}
```

ä¿å­˜ä¸º `ä¸ªä½“å·¥å•†æˆ·å¼€ä¸šç™»è®°ç”³è¯·ä¹¦ï¼ˆJinja2æ¨¡æ¿ï¼‰.docx`

### 3. å‡†å¤‡æ•°æ®

åˆ›å»º JSON æ–‡ä»¶ `data.json`:

```json
{
  "business_name": "å¼ ä¸‰ä¾¿åˆ©åº—",
  "operator_name": "å¼ ä¸‰",
  "phone": "13800138000"
}
```

### 4. ç”Ÿæˆæ–‡æ¡£

```bash
python jinja2_filler.py --data data.json
```

---

## ğŸ“ æ¨¡æ¿åˆ¶ä½œ

### åŸºç¡€å˜é‡

ä½¿ç”¨ `{{å˜é‡å}}` è¯­æ³•ï¼š

```
ä¸ªä½“å·¥å•†æˆ·åç§°ï¼š{{business_name}}
ç»è¥è€…å§“åï¼š{{operator_name}}
```

### æ¡ä»¶åˆ¤æ–­

ä½¿ç”¨ `{% if %}...{% endif %}` è¯­æ³•ï¼š

```
{% if operation_period == 'é•¿æœŸ' %}
ç»è¥æœŸé™ï¼šé•¿æœŸ
{% else %}
ç»è¥æœŸé™ï¼š{{operation_period}}
{% endif %}
```

### å¾ªç¯

ä½¿ç”¨ `{% for %}...{% endfor %}` è¯­æ³•ï¼š

```
ç»è¥èŒƒå›´ï¼š
{% for item in business_scope_list %}
- {{item}}
{% endfor %}
```

### é»˜è®¤å€¼

```
é‚®æ”¿ç¼–ç ï¼š{{postal_code|default('537820')}}
```

### æ—¥æœŸæ ¼å¼åŒ–

```
ç”³è¯·æ—¥æœŸï¼š{{today_year}}å¹´{{today_month}}æœˆ{{today_day}}æ—¥
```

---

## ğŸ“Š æ•°æ®æ ¼å¼

### å®Œæ•´æ•°æ®ç¤ºä¾‹

```json
{
  "business_name": "å¼ ä¸‰ä¾¿åˆ©åº—",
  "operator_name": "å¼ ä¸‰",
  "phone": "13800138000",
  "email": "zhangsan@example.com",
  "business_address": "å¹¿è¥¿ç‰æ—å¸‚å…´ä¸šå¿è’²å¡˜é•‡å•†ä¸šè¡—88å·",
  "postal_code": "537820",
  "employee_count": "3",
  "registered_capital": "50000",
  "id_card": "450101199001011234",
  "gender": "ç”·",
  "nation": "æ±‰æ—",
  "political_status": "ç¾¤ä¼—",
  "education": "é«˜ä¸­",
  "business_scope": "é£Ÿå“é”€å”®ï¼›æ—¥ç”¨ç™¾è´§ï¼›çƒŸè‰åˆ¶å“é›¶å”®",
  "operation_period": "é•¿æœŸ"
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µå | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|--------|------|------|------|
| `business_name` | å­—ç¬¦ä¸² | âœ… | ä¸ªä½“å·¥å•†æˆ·åç§° |
| `operator_name` | å­—ç¬¦ä¸² | âœ… | ç»è¥è€…å§“å |
| `phone` | å­—ç¬¦ä¸² | âœ… | è”ç³»ç”µè¯ |
| `email` | å­—ç¬¦ä¸² | âŒ | ç”µå­é‚®ç®± |
| `business_address` | å­—ç¬¦ä¸² | âœ… | ç»è¥åœºæ‰€åœ°å€ |
| `postal_code` | å­—ç¬¦ä¸² | âŒ | é‚®æ”¿ç¼–ç ï¼ˆé»˜è®¤537820ï¼‰ |
| `employee_count` | å­—ç¬¦ä¸² | âŒ | ä»ä¸šäººæ•° |
| `registered_capital` | å­—ç¬¦ä¸² | âŒ | æ³¨å†Œèµ„é‡‘ï¼ˆå…ƒï¼‰ |
| `id_card` | å­—ç¬¦ä¸² | âœ… | èº«ä»½è¯å·ç  |
| `gender` | å­—ç¬¦ä¸² | âœ… | æ€§åˆ«ï¼ˆç”·/å¥³ï¼‰ |
| `nation` | å­—ç¬¦ä¸² | âŒ | æ°‘æ— |
| `political_status` | å­—ç¬¦ä¸² | âŒ | æ”¿æ²»é¢è²Œ |
| `education` | å­—ç¬¦ä¸² | âŒ | æ–‡åŒ–ç¨‹åº¦ |
| `business_scope` | å­—ç¬¦ä¸² | âŒ | ç»è¥èŒƒå›´ |
| `operation_period` | å­—ç¬¦ä¸² | âŒ | ç»è¥æœŸé™ï¼ˆé»˜è®¤é•¿æœŸï¼‰ |

### è‡ªåŠ¨å¤„ç†å­—æ®µ

å·¥å…·ä¼šè‡ªåŠ¨æ·»åŠ ä»¥ä¸‹å­—æ®µï¼š

- `today`: å½“å‰æ—¥æœŸï¼ˆæ ¼å¼ï¼š2026å¹´01æœˆ12æ—¥ï¼‰
- `today_year`: å½“å‰å¹´ä»½
- `today_month`: å½“å‰æœˆä»½
- `today_day`: å½“å‰æ—¥æœŸ
- `gender_title`: æ€§åˆ«ç§°è°“ï¼ˆå…ˆç”Ÿ/å¥³å£«ï¼‰
- `business_scope_list`: ç»è¥èŒƒå›´åˆ—è¡¨ï¼ˆä»åˆ†å·åˆ†éš”çš„å­—ç¬¦ä¸²è‡ªåŠ¨è½¬æ¢ï¼‰

---

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. æ¡ä»¶æ˜¾ç¤ºå†…å®¹

```
{% if has_license %}
è®¸å¯è¯ç¼–å·ï¼š{{license_number}}
{% endif %}
```

### 2. å¤šæ¡ä»¶åˆ¤æ–­

```
{% if gender == 'ç”·' %}
ç§°å‘¼ï¼šå…ˆç”Ÿ
{% elif gender == 'å¥³' %}
ç§°å‘¼ï¼šå¥³å£«
{% else %}
ç§°å‘¼ï¼šåŒå¿—
{% endif %}
```

### 3. å¾ªç¯ç”Ÿæˆè¡¨æ ¼

åœ¨ Word è¡¨æ ¼ä¸­ä½¿ç”¨ï¼š

```
{% for item in business_scope_list %}
{{item}}
{% endfor %}
```

### 4. åµŒå¥—å¾ªç¯

```
{% for category in categories %}
{{category.name}}ï¼š
  {% for item in category.items %}
  - {{item}}
  {% endfor %}
{% endfor %}
```

### 5. è¡¨æ ¼åŠ¨æ€åˆå¹¶

ä½¿ç”¨ `{% vm %}` å®ç°å‚ç›´åˆå¹¶ï¼š

```
{% vm %}{{content}}{% endvm %}
```

ä½¿ç”¨ `{% hm %}` å®ç°æ°´å¹³åˆå¹¶ï¼š

```
{% hm %}{{content}}{% endhm %}
```

---

## ğŸ’» å‘½ä»¤è¡Œä½¿ç”¨

### æµ‹è¯•æ¨¡å¼

ä½¿ç”¨å†…ç½®æµ‹è¯•æ•°æ®ï¼š

```bash
python jinja2_filler.py --test
```

### å•ä¸ªæ–‡ä»¶å¤„ç†

```bash
python jinja2_filler.py --data my_data.json
```

### æ‰¹é‡å¤„ç†

```bash
python jinja2_filler.py --batch batch_data.json
```

### æŒ‡å®šæ¨¡æ¿

```bash
python jinja2_filler.py --template my_template.docx --data my_data.json
```

### æŒ‡å®šè¾“å‡ºç›®å½•

```bash
python jinja2_filler.py --data my_data.json --output my_output
```

### ä¸è‡ªåŠ¨æ‰“å¼€æ–‡æ¡£

```bash
python jinja2_filler.py --data my_data.json --no-open
```

### éªŒè¯æ¨¡æ¿

æ£€æŸ¥æ¨¡æ¿éœ€è¦å“ªäº›å˜é‡ï¼š

```bash
python jinja2_filler.py --validate my_template.docx
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
æ­£åœ¨éªŒè¯æ¨¡æ¿: my_template.docx

æ¨¡æ¿éœ€è¦ä»¥ä¸‹ 15 ä¸ªå˜é‡:

  - business_address
  - business_name
  - business_scope
  - education
  - email
  - employee_count
  - gender
  - id_card
  - nation
  - operation_period
  - operator_name
  - phone
  - political_status
  - postal_code
  - registered_capital
```

### é™é»˜æ¨¡å¼

å‡å°‘è¾“å‡ºä¿¡æ¯ï¼š

```bash
python jinja2_filler.py --data my_data.json --quiet
```

---

## ğŸ”„ ä»æ—§ç‰ˆè¿ç§»

### ä¸»è¦å˜åŒ–

| æ—§ç‰ˆï¼ˆv2.0ï¼‰ | æ–°ç‰ˆï¼ˆv3.0ï¼‰ |
|-------------|-------------|
| ä½¿ç”¨é¢œè‰²æ ‡è®°ï¼ˆçº¢è‰²/ç»¿è‰²ï¼‰ | ä½¿ç”¨ Jinja2 è¯­æ³• |
| éœ€è¦å­—æ®µæ˜ å°„é…ç½® | ç›´æ¥ä½¿ç”¨å˜é‡å |
| æ¨¡æ¿éœ€è¦è®¾ç½®å­—ä½“é¢œè‰² | æ¨¡æ¿ç›´æ¥è¾“å…¥å˜é‡ |
| ä¸æ”¯æŒæ¡ä»¶é€»è¾‘ | æ”¯æŒå®Œæ•´çš„ Jinja2 åŠŸèƒ½ |

### è¿ç§»æ­¥éª¤

1. **åˆ›å»ºæ–°æ¨¡æ¿**
   - æ‰“å¼€æ—§ç‰ˆæ¨¡æ¿
   - å°†çº¢è‰²å­—ä½“å†…å®¹æ”¹ä¸º `{{å˜é‡å}}`
   - åˆ é™¤é¢œè‰²æ ‡è®°
   - ä¿å­˜ä¸ºæ–°çš„ `.docx` æ–‡ä»¶

2. **å‡†å¤‡æ•°æ®**
   - æ—§ç‰ˆçš„æ•°æ®å¯ä»¥ç›´æ¥ä½¿ç”¨
   - å˜é‡åä¿æŒä¸€è‡´

3. **æµ‹è¯•è¿è¡Œ**
   ```bash
   python jinja2_filler.py --test
   ```

### è¿ç§»ç¤ºä¾‹

**æ—§ç‰ˆæ¨¡æ¿ï¼ˆå¸¦é¢œè‰²ï¼‰**ï¼š
```
[çº¢è‰²å­—ä½“] {{business_name}}
[ç»¿è‰²å­—ä½“] ä¸ªä½“å·¥å•†æˆ·
```

**æ–°ç‰ˆæ¨¡æ¿ï¼ˆJinja2ï¼‰**ï¼š
```
ä¸ªä½“å·¥å•†æˆ·åç§°ï¼š{{business_name}}
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ¨¡æ¿å˜é‡æ²¡æœ‰è¢«æ›¿æ¢ï¼Ÿ

**A**: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. å˜é‡åæ˜¯å¦æ­£ç¡®åŒºåˆ†å¤§å°å†™
2. æ•°æ®ä¸­æ˜¯å¦åŒ…å«è¯¥å˜é‡
3. ä½¿ç”¨ `--validate` æ£€æŸ¥æ¨¡æ¿éœ€è¦çš„å˜é‡

```bash
python jinja2_filler.py --validate my_template.docx
```

### Q2: å¦‚ä½•å¤„ç†å¯é€‰å­—æ®µï¼Ÿ

**A**: ä½¿ç”¨æ¡ä»¶åˆ¤æ–­ï¼š

```
{% if email %}
ç”µå­é‚®ç®±ï¼š{{email}}
{% endif %}
```

### Q3: ç»è¥èŒƒå›´å¦‚ä½•åˆ†æ¡æ˜¾ç¤ºï¼Ÿ

**A**: ä¸¤ç§æ–¹æ³•

**æ–¹æ³•1ï¼šä½¿ç”¨åˆ†å·åˆ†éš”**
```json
{
  "business_scope": "é£Ÿå“é”€å”®ï¼›æ—¥ç”¨ç™¾è´§ï¼›çƒŸè‰åˆ¶å“"
}
```
å·¥å…·ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºåˆ—è¡¨

**æ–¹æ³•2ï¼šç›´æ¥æä¾›åˆ—è¡¨**
```json
{
  "business_scope_list": ["é£Ÿå“é”€å”®", "æ—¥ç”¨ç™¾è´§", "çƒŸè‰åˆ¶å“"]
}
```

### Q4: å¦‚ä½•ç”Ÿæˆè¡¨æ ¼ï¼Ÿ

**A**: åœ¨ Word è¡¨æ ¼ä¸­ä½¿ç”¨å¾ªç¯

åˆ›å»ºè¡¨æ ¼ï¼Œåœ¨å•å…ƒæ ¼ä¸­è¾“å…¥ï¼š
```
{% for item in business_scope_list %}
{{item}}
{% endfor %}
```

### Q5: å¦‚ä½•è®¾ç½®é»˜è®¤å€¼ï¼Ÿ

**A**: ä¿®æ”¹ `config.json` æ–‡ä»¶ï¼š

```json
{
  "constants": {
    "postal_code_default": "537820",
    "operation_period_default": "é•¿æœŸ"
  }
}
```

### Q6: èƒ½å¦åœ¨æ¨¡æ¿ä¸­è¿›è¡Œè®¡ç®—ï¼Ÿ

**A**: å¯ä»¥ï¼Œä½¿ç”¨ Jinja2 è¡¨è¾¾å¼ï¼š

```
æ€»é‡‘é¢ï¼š{{amount * quantity}}å…ƒ
```

### Q7: å¦‚ä½•è°ƒè¯•æ¨¡æ¿ï¼Ÿ

**A**: ä½¿ç”¨éªŒè¯åŠŸèƒ½ï¼š

```bash
python jinja2_filler.py --validate my_template.docx
```

è¿™ä¼šæ˜¾ç¤ºæ¨¡æ¿éœ€è¦çš„æ‰€æœ‰å˜é‡ï¼Œå¸®åŠ©æ‚¨æ£€æŸ¥æ•°æ®æ˜¯å¦å®Œæ•´ã€‚

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ¨¡æ¿è®¾è®¡

- âœ… ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å
- âœ… ä¿æŒå˜é‡å‘½åä¸€è‡´
- âœ… æ·»åŠ æ³¨é‡Šè¯´æ˜
- âœ… ä½¿ç”¨æ¡ä»¶åˆ¤æ–­å¤„ç†å¯é€‰å­—æ®µ

### 2. æ•°æ®å‡†å¤‡

- âœ… ä½¿ç”¨ JSON æ ¼å¼
- âœ… éªŒè¯å¿…å¡«å­—æ®µ
- âœ… æ£€æŸ¥æ•°æ®æ ¼å¼
- âœ… ä½¿ç”¨æ‰¹é‡å¤„ç†æé«˜æ•ˆç‡

### 3. å·¥ä½œæµç¨‹

```
1. åˆ›å»º/ä¿®æ”¹æ¨¡æ¿ï¼ˆWordï¼‰
2. éªŒè¯æ¨¡æ¿ï¼ˆ--validateï¼‰
3. å‡†å¤‡æ•°æ®ï¼ˆJSONï¼‰
4. æµ‹è¯•ç”Ÿæˆï¼ˆ--testï¼‰
5. æ‰¹é‡å¤„ç†ï¼ˆ--batchï¼‰
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### Jinja2 å®˜æ–¹æ–‡æ¡£

- [Jinja2 æ¨¡æ¿è¯­æ³•](https://jinja.palletsprojects.com/)
- [Jinja2 è¿‡æ»¤å™¨](https://jinja.palletsprojects.com/templates/#builtin-filters)

### python-docx-template

- [GitHub ä»“åº“](https://github.com/elapouya/python-docx-template)
- [åœ¨çº¿æ–‡æ¡£](http://docxtpl.readthedocs.org/)

### æœ¬é¡¹ç›®ç›¸å…³

- [æ—§ç‰ˆä½¿ç”¨æŒ‡å—](æå¥•å‡¤ç‰ˆç”³è¯·ä¹¦ä½¿ç”¨æŒ‡å—.md)
- [é…ç½®æ–‡ä»¶](config.json)
- [æµ‹è¯•æ•°æ®](test_data_jinja2.json)

---

## ğŸ¤ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æŒ‡å—çš„[å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)éƒ¨åˆ†
2. ä½¿ç”¨ `--validate` æ£€æŸ¥æ¨¡æ¿
3. ä½¿ç”¨ `--test` æµ‹è¯•åŠŸèƒ½
4. æŸ¥çœ‹ç”Ÿæˆçš„ `.json` æ•°æ®æ–‡ä»¶

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
